
/**
 * 由 Fantastic-admin 提供技术支持
 * https://hooray.gitee.io/fantastic-admin/
 * Powered by Fantastic-admin
 * https://hooray.github.io/fantastic-admin/
 */
    
import{_ as h}from"./index.35de4a3a.js";import{C as f}from"./index.384ab11c.js";import{_ as k}from"./index.f1e12eef.js";import{H as n}from"./index.94e839d6.js";import{_ as x}from"./plugin-vue_export-helper.21dcd24c.js";import{E as d,r as p,a as C,c as q,z as o,t as l,y as r,A as j,F as V,G as v,H as c}from"./vendor.d2559d84.js";import"./index.a5dee889.js";import"./index.41459e6c.js";import"./word-img.bb3865fc.js";import"./drag.56588ea6.js";import"./sortable.esm.81321d43.js";import"./index.5931791c.js";import"./index.a3c908a5.js";import"./formValidate.137fd30a.js";const N={name:"KnowledgeBaseAddOrEdit",components:{customerSelect:h,CustomerMedia:f},data(){return{treeData:[{id:"\u603B\u90E8\u6807\u7B7E",name:"\u603B\u90E8\u6807\u7B7E",childrens:[{id:"\u6D88\u8D39\u6C34\u5E73",name:"\u6D88\u8D39\u6C34\u5E73",childrens:[{id:"5\u4E07\u5143/\u6708",name:"5\u4E07\u5143/\u6708",num:4}]}]},{id:"\u670D\u52A1\u6807\u7B7E",name:"\u670D\u52A1\u6807\u7B7E",childrens:[{id:"\u60C5\u611F\u9700\u6C42",name:"\u60C5\u611F\u9700\u6C42",childrens:[{id:"\u7F3A\u81EA\u4FE1",name:"\u7F3A\u81EA\u4FE1",num:4}]}]}],selectList:[],contentLength:0,content_arr:[],treeChecked:[]}},watch:{},mounted(){if(this.getTagGroup(),this.$route.query.sale_script_id&&this.getSaleScriptDetail(),this.$route.query.selected){let e=JSON.parse(this.$route.query.selected);this.selectList.push({tag_id:e.tag_id,tag_group_name:e.tag_group_name,tag_type:e.tag_type,name:e.name})}console.log(this.$route.query.selected)},methods:{async getSaleScriptDetail(){let{data:e}=await n.getSaleScriptDetail({sale_script_id:this.$route.query.sale_script_id});this.selectList=e.tag_arr,e.content_arr.forEach(t=>{if(t.type==="LINK"){let s=t.qw_link_url.split("//");t.qw_link_url=s[1],t.url=s[0]+"//"}}),this.content_arr=e.content_arr,console.log(e)},getTagGroup(){n.getTagGroup().then(e=>{console.log("res",e);let t=e.data;console.log(t)})},cancelData(){this.$router.go(-1)},async sumitKnowdeage(){let e=[];if(this.treeChecked.length===0){d.error("\u8BF7\u9009\u62E9\u6807\u7B7E");return}if(this.treeChecked.forEach(s=>{e.push(s.tag_id)}),!this.content_arr.length){d.error({message:"\u6807\u7B7E\u8425\u9500\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A!"});return}let t=JSON.parse(JSON.stringify(this.content_arr));t.forEach(s=>{s.type==="LINK"&&(s.qw_link_url=s.url+s.qw_link_url)}),this.$route.query.sale_script_id?(await n.updateSaleScript({content_arr:t,tag_id_arr:e,sale_script_id:this.$route.query.sale_script_id})).code===200&&(d.success("\u7F16\u8F91\u6210\u529F\uFF01"),setTimeout(()=>{this.$router.replace({name:"labelSale",query:{selected:JSON.stringify(this.treeChecked)}})},500)):(await n.addSaleScript({content_arr:t,tag_id_arr:e})).code===200&&(d.success("\u6DFB\u52A0\u6210\u529F\uFF01"),setTimeout(()=>{this.$router.replace({name:"labelSale",query:{selected:JSON.stringify(this.treeChecked)}})},500))},resetForm(e){this.$refs[e].resetFields()}}},g=e=>(V("data-v-2b2b9fb5"),e=e(),v(),e),L={class:"search-head-wrap flex-row-between bg-color-fff p-24"},D=g(()=>l("label",{class:"el-form-item__label"},[l("i",{class:"color-red"},"*"),c(" \u6807\u7B7E "),l("span",{class:"el-form-item_label-span"}," \u547D\u4E2D\u6807\u7B7E\u8D8A\u591A\uFF0C\u6392\u540D\u8D8A\u9760\u524D ")],-1)),I={class:"el-form-item__label"},$=g(()=>l("i",{class:"color-red"},"*",-1)),E=c(" \u6807\u7B7E\u8425\u9500\u5185\u5BB9 "),O={class:"el-form-item_label-span"},T=c("\u53D6 \u6D88"),F=c("\u63D0 \u4EA4");function J(e,t,s,K,a,u){const b=h,_=p("el-form-item"),S=f,m=p("el-button"),y=p("el-form"),w=k;return C(),q(w,{class:""},{default:o(()=>[l("div",L,[r(y,{ref:"ruleForm",modelValue:e.addknowInfo,"onUpdate:modelValue":t[2]||(t[2]=i=>e.addknowInfo=i),class:"demo-ruleForm",height:"32px","label-width":"520px","label-position":"top"},{default:o(()=>[r(_,{required:""},{default:o(()=>[D,r(b,{modelValue:a.treeChecked,"onUpdate:modelValue":t[0]||(t[0]=i=>a.treeChecked=i),"tree-data":a.treeData,"edit-select-list":a.selectList},null,8,["modelValue","tree-data","edit-select-list"])]),_:1}),r(_,{required:""},{default:o(()=>[l("label",I,[$,E,l("span",O," \u53EF\u6DFB\u52A0\u7D20\u6750\u6570\u91CF "+j(a.content_arr.length)+"/10 ",1)]),r(S,{modelValue:a.content_arr,"onUpdate:modelValue":t[1]||(t[1]=i=>a.content_arr=i),"text-limit":800},null,8,["modelValue"])]),_:1}),r(_,{class:"item-button tr"},{default:o(()=>[r(m,{size:"small",onClick:u.cancelData},{default:o(()=>[T]),_:1},8,["onClick"]),r(m,{type:"primary",size:"small",onClick:u.sumitKnowdeage},{default:o(()=>[F]),_:1},8,["onClick"])]),_:1})]),_:1},8,["modelValue"])])]),_:1})}var ee=x(N,[["render",J],["__scopeId","data-v-2b2b9fb5"]]);export{ee as default};
