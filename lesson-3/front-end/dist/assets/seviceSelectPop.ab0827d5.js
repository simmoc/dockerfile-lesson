
/**
 * 由 Fantastic-admin 提供技术支持
 * https://hooray.gitee.io/fantastic-admin/
 * Powered by Fantastic-admin
 * https://hooray.github.io/fantastic-admin/
 */
    
import{_ as Z}from"./select-member.d05cd3eb.js";import{_ as ee}from"./index.a5dee889.js";import{_ as te}from"./index.333b158c.js";import{_ as ae}from"./index.6ba23372.js";import{M as d,r as p,a as r,q as i,t as a,H as g,A as u,y as _,z as n,L as le,R as y,S as w,D as x,v as S,x as F,c as k,J as se,E as re}from"./vendor.d2559d84.js";import{H as oe}from"./index.94e839d6.js";import ne from"./groupTree.e67e2135.js";import"./tick@2x.1e6bc440.js";import"./vuedraggable.umd.56963d08.js";import"./sortable.esm.81321d43.js";import"./plugin-vue_export-helper.21dcd24c.js";const ie={class:"select-page"},_e={class:"search-box pb20"},ce=g("\u91CD\u7F6E"),de=g("\u67E5\u8BE2"),me={class:"data-box flex pt24"},ue={class:"search-tree flex-g0 flex-s0"},pe={class:"tab-box flex-g1 flex-s1 pl16"},ge={class:"cate-name fs16 c26 fwb"},ve=g("\xA0"),he={class:""},be=["src"],fe={class:"textClass"},ye={key:0},we={key:1,class:"event-list-page flex"},xe={class:"icon-in-td"},ke=["src","alt"],Ve={class:"cl-blue member-name"},Ce={class:"event-list-page flex"},je={class:"icon-in-td"},qe=["src","alt"],Se={class:"cl-blue member-name"},Fe={class:"event-list-page"},Te={class:"icon-in-td"},ze=["src","alt"],Ie={class:"cl-blue member-name"},Me={key:0},De={class:"member-tag-pop"},He=a("span",null,"...",-1),Ue={key:2},Je={props:{selectItem:{type:Object,default:()=>{}}},emits:["update:selectItem","selectCode"],setup(U,{emit:$}){const v=U,L="https://we-customer-api.freshgood.cn",h=d(!1),b=d([]),o=d({search_name:"",start_time:"",end_time:"",search_member_id_arr:[],search_department_id_arr:[],page_num:1,page_size:10,group_id:""}),T=d({}),z=d({member_code_id:v.selectItem.member_code_id,type:v.selectItem.type}),V=d([]),I=d(0);console.log(v);const B=d([{label:"",prop:"select",type:"slot",width:50},{label:"\u4E8C\u7EF4\u7801",prop:"code_url",width:96,type:"slot"},{label:"\u6210\u5458\u6D3B\u7801\u540D\u79F0",prop:"code_name",width:120},{label:"\u914D\u7F6E\u6210\u5458",prop:"member_arr",width:180,type:"slot"},{label:"\u63CF\u8FF0",prop:"code_description",width:100},{label:"\u521B\u5EFA\u65F6\u95F4",prop:"create_time",width:180},{label:"\u5F15\u6D41\u4EBA\u6570",prop:"code_drainage_num"},{label:"\u5173\u8054\u6807\u7B7E",prop:"tag_arr",type:"slot",width:278}]),C=d(null),j=d([]),N=s=>{let l={member_code_id:s.code_id,type:v.selectItem.type};$("update:selectItem",l)};function R(s,l){const c=200;return l>=c?(re({message:`\u6700\u591A\u652F\u6301\u5BA2\u6237\u4EBA\u6570${c}\u4EBA`,type:"error"}),!1):!0}function Y(s){j.value=s;let l=[],c=[];s&&Array.isArray(s)&&(s.map(m=>{m.isOrg?c.push(m.id):l.push(m.id)}),o.value.search_member_id_arr=l,o.value.search_department_id_arr=c),C.value&&(C.value.dialogVisible=!1)}function A(s,l){return`${s.slice(0,l).map(c=>c.member_name||c.department_name).join("\uFF0C")}${s.length>l?"...":""}`}const E=()=>{if(b.value[0]){o.value.start_time=b.value[0],o.value.end_time=b.value[1];return}o.value.start_time="",o.value.end_time=""},O=s=>{if(!s){V.value=[];return}T.value=s,o.value.group_id=s.id||"",M()},Q=()=>{o.value={search_name:"",start_time:"",end_time:"",search_member_id_arr:[],search_department_id_arr:[],page_num:1,page_size:10,group_id:""},j.value=[],h.value=!h.value},M=async()=>{const{data:s}=await oe.getmemberList(o.value);V.value=s.list||[],I.value=s.total_num||0};return(s,l)=>{const c=p("el-input"),m=p("el-form-item"),G=Z,J=p("el-date-picker"),D=p("el-button"),P=p("el-form"),K=p("el-radio"),H=p("el-popover"),q=ee,W=te,X=ae;return r(),i("div",ie,[a("div",_e,[g(u(v.grouList)+" ",1),_(P,{inline:!0,model:o.value,"label-position":"right","label-width":"120px",size:"small",class:"search-form-margin clearfix"},{default:n(()=>[_(m,{label:"\u6210\u5458\u6D3B\u7801\u540D\u79F0\uFF1A"},{default:n(()=>[_(c,{modelValue:o.value.search_name,"onUpdate:modelValue":l[0]||(l[0]=t=>o.value.search_name=t),placeholder:"\u8BF7\u8F93\u5165\u6587\u672C\u5185\u5BB9",style:{width:"274px"}},null,8,["modelValue"])]),_:1}),_(m,{label:"\u914D\u7F6E\u6210\u5458\uFF1A"},{default:n(()=>[_(G,{ref_key:"addMemberDialogRef",ref:C,"input-placeholder":"\u8BF7\u9009\u62E9\u4F01\u5FAE\u6210\u5458","is-multiple-selected":!0,"custom-selected-fn":R,"write-back-selected-member-org":j.value,"custom-input-value-fn":t=>A(t,3),style:{width:"274px"},onConfirm:Y},{default:n(t=>[_(c,{modelValue:t.data,"onUpdate:modelValue":e=>t.data=e,placeholder:"\u8BF7\u9009\u62E9","suffix-icon":"el-icon-arrow-down",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["write-back-selected-member-org","custom-input-value-fn"])]),_:1}),_(m,{label:"\u521B\u5EFA\u65F6\u95F4\uFF1A"},{default:n(()=>[_(J,{modelValue:b.value,"onUpdate:modelValue":l[1]||(l[1]=t=>b.value=t),"value-format":"YYYY-MM-DD HH:mm:ss",type:"datetimerange","range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F",align:"right",onChange:E},null,8,["modelValue"])]),_:1}),_(m,{class:"right mr0"},{default:n(()=>[_(D,{type:"default",size:"small",onClick:Q},{default:n(()=>[ce]),_:1}),_(D,{type:"primary",size:"small",onClick:l[2]||(l[2]=t=>h.value=!h.value)},{default:n(()=>[de]),_:1})]),_:1})]),_:1},8,["model"])]),a("div",me,[a("div",ue,[_(ne,{ref:"crudClassifyTree","on-search":h.value,params:o.value,onSelectItem:O},null,8,["on-search","params"])]),a("div",pe,[a("div",ge,u(T.value.name),1),_(W,{"table-title":B.value,"table-data":V.value,"need-pagination":!0,height:"calc(100vh - 450px)",class:se(["cs-goods-table",{"is-collapse":s.$store.state.settings.mode==="pc"&&s.$store.state.settings.sidebarCollapse}])},{select:n(t=>[_(K,{modelValue:z.value.member_code_id,"onUpdate:modelValue":l[3]||(l[3]=e=>z.value.member_code_id=e),label:t.data.code_id,onClick:e=>N(t.data)},{default:n(()=>[ve]),_:2},1032,["modelValue","label","onClick"])]),code_url:n(t=>[a("div",he,[a("img",{class:"qr-img",src:le(L)+t.data.code_url,alt:"\u4E8C\u7EF4\u7801"},null,8,be)])]),member_arr:n(({data:t})=>[a("label",fe,[t.member_arr[0]?t.member_arr.length==1?(r(),i("span",we,[(r(!0),i(y,null,w(t.member_arr,(e,f)=>(r(),i("span",{key:f},[a("div",xe,[e.qw_avatar?(r(),i("img",{key:0,src:e.qw_avatar,alt:e.qw_avatar},null,8,ke)):x("",!0)]),a("span",Ve,[a("div",null,[g(u(e.qw_name),1),S(a("span",null," / "+u(e.parent_name),513),[[F,e.parent_name]])])])]))),128))])):(r(),k(H,{key:2,width:"400",trigger:"click"},{reference:n(()=>[a("span",Fe,[(r(!0),i(y,null,w(t.member_arr.slice(0,1),(e,f)=>(r(),i("span",{key:f,class:"mr8"},[a("div",Te,[e.qw_avatar?(r(),i("img",{key:0,src:e.qw_avatar,alt:e.qw_avatar},null,8,ze)):x("",!0)]),a("span",Ie,[g(u(e.qw_name)+" ",1),S(a("span",null," / "+u(e.parent_name)+" ... ",513),[[F,e.parent_name]])])]))),128))])]),default:n(()=>[a("div",Ce,[(r(!0),i(y,null,w(t.member_arr,(e,f)=>(r(),i("span",{key:f,class:"mr16"},[a("div",je,[e.qw_avatar?(r(),i("img",{key:0,src:e.qw_avatar,alt:e.qw_avatar},null,8,qe)):x("",!0)]),a("span",Se,[a("div",null,[g(u(e.qw_name)+" ",1),S(a("span",null," / "+u(e.parent_name),513),[[F,e.parent_name]])])])]))),128))])]),_:2},1024)):(r(),i("span",ye," \u2014 "))])]),tag_arr:n(t=>[t.data.tag_arr.length<=1?(r(),i("div",Me,[(r(!0),i(y,null,w(t.data.tag_arr,e=>(r(),k(q,{key:e.tag_name,"left-title":e.tag_group_name,"right-title":e.tag_name,color:e.tag_group_type==="HQ"?"#409eff":"#FF6F00","customer-style":{"margin-bottom":0}},null,8,["left-title","right-title","color"]))),128))])):(r(),k(H,{key:1,placement:"bottom",trigger:"hover","popper-class":"key-word-pop",width:"542"},{reference:n(()=>[a("div",null,[_(q,{"left-title":t.data.tag_arr[0].tag_group_name,"right-title":t.data.tag_arr[0].tag_name,color:t.data.tag_arr[0].tag_group_type==="HQ"?"#409eff":"#FF6F00","customer-style":{"margin-bottom":0}},null,8,["left-title","right-title","color"]),He])]),default:n(()=>[a("div",De,[(r(!0),i(y,null,w(t.data.tag_arr,e=>(r(),k(q,{key:e.tag_name,"left-title":e.tag_group_name,"right-title":e.tag_name,color:e.tag_group_type==="HQ"?"#409eff":"#FF6F00","right-text-break":!1,"right-text-auto":!0},null,8,["left-title","right-title","color"]))),128))])]),_:2},1024)),t.data.tag_arr[0]?x("",!0):(r(),i("div",Ue,"\u2014"))]),_:1},8,["table-title","table-data","height","class"]),_(X,{limit:o.value.page_size,"onUpdate:limit":l[4]||(l[4]=t=>o.value.page_size=t),page:o.value.page_num,"onUpdate:page":l[5]||(l[5]=t=>o.value.page_num=t),total:I.value,"get-data":M},null,8,["limit","page","total"])])])])}}};export{Je as default};
