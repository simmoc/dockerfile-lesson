
/**
 * 由 Fantastic-admin 提供技术支持
 * https://hooray.gitee.io/fantastic-admin/
 * Powered by Fantastic-admin
 * https://hooray.github.io/fantastic-admin/
 */
    
import{_ as oe}from"./index.c2096f13.js";import{a as n,q as V,t as a,V as ie,K as de,C as ne,F as E,G,O as re,P as _e,M as u,o as ue,r as c,L as M,A as m,D as g,y as l,z as o,R as ce,S as me,c as h,H as v,E as f,a6 as pe}from"./vendor.d2559d84.js";import{a as ge}from"./drag.56588ea6.js";import{_ as N}from"./plugin-vue_export-helper.21dcd24c.js";import{_ as ve}from"./index.f1e12eef.js";import{H as I}from"./index.94e839d6.js";import he from"./addGoods.0c59a042.js";import{d as fe}from"./vuedraggable.umd.56963d08.js";import"./sortable.esm.81321d43.js";const ye=r=>(E("data-v-499d7452"),r=r(),G(),r),be={class:"customer-media-item"},we=ye(()=>a("img",{class:"drag-icon",src:ge,alt:""},null,-1)),xe=["onClick"],Ve={props:{mediaContentWidth:{type:Number,default:440}},emits:["deleteItem"],setup(r,{emit:y}){const b=r,e=()=>{console.log(b),y("deleteItem")};return(C,p)=>(n(),V("div",be,[we,a("div",{class:"media-content",style:de({width:r.mediaContentWidth+"px"})},[ie(C.$slots,"default",{},void 0,!0)],4),a("i",{class:"el-icon-delete-solid pointer",onClick:ne(e,["stop"])},null,8,xe)]))}};var ke=N(Ve,[["__scopeId","data-v-499d7452"]]);const k=r=>(E("data-v-1ab297ea"),r=r(),G(),r),Ce={class:"mt16"},Se={class:"page-scroll"},Ie={key:0,class:"head-content"},qe={class:"head-content-item"},Ue={class:"head-content-item"},De={class:"head-content-item"},je={class:"head-content-item"},Be={class:"width-box-class"},Ee={class:"width-box-class"},Ge={class:"width-box-class"},Me={class:"width-box-class"},Ne=k(()=>a("div",{class:"mt8 c8c fs12 lh22"},"\u5EFA\u8BAE\u5C3A\u5BF8\uFF1A800*248\u50CF\u7D20",-1)),$e={class:"width-box-class"},ze={class:"width-box-class"},Te={class:"width-box-class"},Re={class:"width-box-class"},He=k(()=>a("div",{class:"mt8 c8c fs12 lh22"},"\u5EFA\u8BAE\u5C3A\u5BF8\uFF1A800*\u9AD8\u5EA6\u4E0D\u9650\uFF0C\u6700\u591A\u4E0A\u4F2010\u5F20",-1)),Oe={class:"width-box-class"},Ae=k(()=>a("div",{class:"mt8 c8c fs12 lh22"},"\u5EFA\u8BAE\u5C3A\u5BF8\uFF1A800*\u9AD8\u5EA6\u4E0D\u9650\uFF0C\u6700\u591A\u4E0A\u4F2010\u5F20",-1)),Je={class:"width-box-class mt24"},Pe=k(()=>a("label",{class:"el-form-item__label"},[a("i",{class:"color-red"},"*"),v(" \u5173\u8054\u5546\u54C1 ")],-1)),Ye={key:0},Fe={class:"flex flex-align-center ml8 mt8 mb8 mr12"},Le=["src"],We={class:"goods-content ml8 lh24"},Ke={class:"goods-title overflow-ellipsis"},Qe={class:"flex flex-justify-between goods-score-status"},Xe=k(()=>a("i",{class:"el-icon-plus"},null,-1)),Ze=v(" \u6DFB\u52A0\u5546\u54C1 "),et={class:"width-box-class mt24"},tt={class:"mt24 tr"},at=v("\u53D6\u6D88"),st=v("\u63D0\u4EA4"),lt={class:"mr24 select-goods"},ot=v(" \u5F53\u524D\u5DF2\u9009\u62E9 "),it={class:"select-goods-text"},dt=v(" \u4EF6\u5546\u54C1 "),nt={class:"dialog-footer"},rt=v("\u53D6\u6D88"),_t=v("\u786E\u8BA4"),ut={setup(r){const y=re(),b=_e(),e=u({name:"",type:"not_associated_goods",banner_img:"",start_time:"",end_time:"",mini_program_title:"",associated_mini_program:"",app_id:"",page_url:"",detail_img_first:[],detail_img_last:[],associated_goods_data:[]}),C=u([]),p=u([]),d=u([]),q=u([]),j=u({}),$=u({name:[{required:!0,message:"\u8F6E\u64AD\u56FE\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],type:[{required:!0,message:"\u8F6E\u64AD\u56FE\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],start_time:[{required:!0,message:"\u8F6E\u64AD\u56FE\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],mini_program_title:[{required:!0,message:"\u5C0F\u7A0B\u5E8F\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],app_id:[{required:!0,message:"\u5C0F\u7A0B\u5E8FAppid\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],page_url:[{required:!0,message:"\u5C0F\u7A0B\u5E8FPage\u8DEF\u5F84\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],banner_img:[{required:!0,message:"\u9996\u9875\u8F6E\u64AD\u56FE\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],detail_img_first:[{type:"array",required:!0,message:"\u8BE6\u60C5\u9875\u9996\u56FE\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),U=u(!1),w=u(!1),z=u([new Date(2e3,1,1,0,0,0),new Date(2e3,2,1,23,59,59)]),T=async()=>{let{data:i}=await I.getBannertype();C.value=i},R=()=>{if(p.value&&p.value[0]){e.value.start_time=p.value[0],e.value.end_time=p.value[1];return}e.value.start_time="",e.value.end_time=""},H=async()=>{if(d.value.length>0&&e.value.type=="associated_goods"?(e.value.associated_goods_data=[],d.value.forEach((i,t)=>{e.value.associated_goods_data[t]={},e.value.associated_goods_data[t].goods_class_id=i.goods_class_id,e.value.associated_goods_data[t].sort=i.sort,e.value.associated_goods_data[t].score_goods_id=i.score_goods_id})):d.value=[],e.value.name==""||e.value.type==""||e.value.start_time==""||e.value.banner_img==""){f.warning({message:"\u60A8\u6709\u9009\u9879\u672A\u586B\u5199\uFF0C\u8BF7\u586B\u5199\u5B8C\u6BD5\u518D\u63D0\u4EA4"});return}else if(e.value.type=="not_associated_goods"){if(JSON.stringify(e.value.detail_img_first)=="[]"){f.warning({message:"\u60A8\u6709\u9009\u9879\u672A\u586B\u5199\uFF0C\u8BF7\u586B\u5199\u5B8C\u6BD5\u518D\u63D0\u4EA4"});return}}else if(e.value.type=="associated_goods"){if(JSON.stringify(e.value.detail_img_first)=="[]"||JSON.stringify(e.value.associated_goods_data)=="[]"){f.warning({message:"\u60A8\u6709\u9009\u9879\u672A\u586B\u5199\uFF0C\u8BF7\u586B\u5199\u5B8C\u6BD5\u518D\u63D0\u4EA4"});return}}else if(e.value.mini_program_title==""||e.value.app_id==""||e.value.page_url==""){f.warning({message:"\u60A8\u6709\u9009\u9879\u672A\u586B\u5199\uFF0C\u8BF7\u586B\u5199\u5B8C\u6BD5\u518D\u63D0\u4EA4"});return}e.value.associated_goods_data=JSON.stringify(e.value.associated_goods_data),y.query.pageType=="add"?(await I.addBanner(e.value)).code===200&&(f.success({message:"\u65B0\u589E\u6210\u529F"}),b.push({name:"rotationManage"})):(await I.updateBannerEdit(e.value)).code===200&&(f.success({message:"\u4FEE\u6539\u6210\u529F"}),b.push({name:"rotationManage"}))},O=()=>{b.push({name:"rotationManage"})},A=()=>{d.value.forEach((i,t)=>{d.value[t].sort=200-t})},J=async i=>{let{data:t}=await I.getBannerDetail({id:i});t.detail_img_last||(t.detail_img_last=[]),t.detail_img_first||(t.detail_img_first=[]),t.type=="associated_goods"&&(d.value=t.associated_goods_data),e.value=t,p.value.push(e.value.start_time,e.value.end_time)},P=(i,t)=>{e.value[i]=t[0]||""},Y=i=>{if(q.value=i,d.value.length>100){f.warning({message:"\u5F53\u524D\u5173\u8054\u5546\u54C1\u6570\u91CF\u8D85\u8FC7100\u4EF6\uFF0C\u8BF7\u51CF\u5C11\u81F3100\u4EF6\u5546\u54C1!"});return}},F=()=>{d.value=q.value,w.value=!1},L=i=>{d.value.splice(i,1)},W=()=>{w.value=!0,j.value=d.value,pe(()=>{U.value=!U.value})},B=()=>{w.value=!1};return ue(()=>{T(),y.query.pageType=="edit"&&J(y.query.banner_id)}),(i,t)=>{const S=c("el-input"),_=c("el-form-item"),K=c("el-option"),Q=c("el-select"),X=c("el-date-picker"),D=oe,Z=c("el-popover"),ee=ke,x=c("el-button"),te=c("el-form"),ae=ve,se=c("el-dialog");return n(),V("div",Ce,[a("div",Se,[M(y).query.pageType=="edit"?(n(),V("div",Ie,[a("div",qe," \u521B\u5EFA\u6210\u5458\uFF1A"+m(e.value.creator_name||"\u2014"),1),a("div",Ue," \u521B\u5EFA\u65F6\u95F4\uFF1A"+m(e.value.create_time||"\u2014"),1),a("div",De," \u6700\u540E\u4FEE\u6539\u6210\u5458\uFF1A"+m(e.value.update_name||"\u2014"),1),a("div",je," \u6700\u540E\u4FEE\u6539\u65F6\u95F4\uFF1A"+m(e.value.update_time||"\u2014"),1)])):g("",!0),l(ae,{class:"mt0"},{default:o(()=>[l(te,{size:"small","label-position":"top","label-width":"520px",model:e.value,rules:$.value},{default:o(()=>[l(_,{label:"\u8F6E\u64AD\u56FE\u540D\u79F0",prop:"name"},{default:o(()=>[a("div",Be,[l(S,{modelValue:e.value.name,"onUpdate:modelValue":t[0]||(t[0]=s=>e.value.name=s),maxlength:"20","show-word-limit":"",placeholder:"\u8BF7\u8F93\u5165\u8F6E\u64AD\u56FE\u540D\u79F0"},null,8,["modelValue"])])]),_:1}),l(_,{label:"\u8F6E\u64AD\u56FE\u7C7B\u578B",prop:"type"},{default:o(()=>[a("div",Ee,[l(Q,{modelValue:e.value.type,"onUpdate:modelValue":t[1]||(t[1]=s=>e.value.type=s),style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u8F6E\u64AD\u56FE\u7C7B\u578B"},{default:o(()=>[(n(!0),V(ce,null,me(C.value,s=>(n(),h(K,{key:s.key,label:s.value,value:s.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1}),l(_,{label:"\u8F6E\u64AD\u56FE\u5C55\u793A\u65F6\u95F4",prop:"start_time"},{default:o(()=>[a("div",Ge,[l(X,{modelValue:p.value,"onUpdate:modelValue":t[2]||(t[2]=s=>p.value=s),"value-format":"YYYY-MM-DD HH:mm:ss","default-time":z.value,type:"datetimerange","range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F",align:"right",style:{width:"100%"},onChange:R},null,8,["modelValue","default-time"])])]),_:1}),l(_,{label:"\u9996\u9875\u8F6E\u64AD\u56FE",prop:"banner_img"},{default:o(()=>[a("div",Me,[l(D,{url:e.value.banner_img?[e.value.banner_img]:[],max:1,width:80,height:80,onUrlChange:t[3]||(t[3]=s=>P("banner_img",s))},null,8,["url"]),Ne])]),_:1}),e.value.type=="associated_mini_program"?(n(),h(_,{key:0,label:"\u5C0F\u7A0B\u5E8F\u540D\u79F0",prop:"mini_program_title"},{default:o(()=>[a("div",$e,[l(S,{modelValue:e.value.mini_program_title,"onUpdate:modelValue":t[4]||(t[4]=s=>e.value.mini_program_title=s),maxlength:"30","show-word-limit":"",placeholder:"\u8BF7\u8F93\u5165\u5C0F\u7A0B\u5E8F\u540D\u79F0"},null,8,["modelValue"])])]),_:1})):g("",!0),e.value.type=="associated_mini_program"?(n(),h(_,{key:1,label:"\u5C0F\u7A0B\u5E8FAppid\uFF1A",prop:"app_id"},{default:o(()=>[a("div",ze,[l(S,{modelValue:e.value.app_id,"onUpdate:modelValue":t[5]||(t[5]=s=>e.value.app_id=s),maxlength:"32","show-word-limit":"",placeholder:"\u8BF7\u8F93\u5165\u5C0F\u7A0B\u5E8FAppid"},null,8,["modelValue"])])]),_:1})):g("",!0),e.value.type=="associated_mini_program"?(n(),h(_,{key:2,label:"\u5C0F\u7A0B\u5E8FPage\u8DEF\u5F84\uFF1A",prop:"page_url"},{default:o(()=>[a("div",Te,[l(S,{modelValue:e.value.page_url,"onUpdate:modelValue":t[6]||(t[6]=s=>e.value.page_url=s),maxlength:"200","show-word-limit":"",placeholder:"\u8BF7\u8F93\u5165\u5C0F\u7A0B\u5E8FPage\u8DEF\u5F84",type:"textarea",autosize:{minRows:2,maxRows:4}},null,8,["modelValue"])])]),_:1})):g("",!0),e.value.type!="associated_mini_program"?(n(),h(_,{key:3,label:"\u8BE6\u60C5\u9875\u9996\u56FE",prop:"detail_img_first"},{default:o(()=>[a("div",Re,[l(D,{url:e.value.detail_img_first,"onUpdate:url":t[7]||(t[7]=s=>e.value.detail_img_first=s),max:10,width:80,height:80},null,8,["url"]),He])]),_:1})):g("",!0),e.value.type=="associated_goods"?(n(),h(_,{key:4,label:"\u8BE6\u60C5\u9875\u5C3E\u56FE",prop:"detail_img_last"},{default:o(()=>[a("div",Oe,[l(D,{url:e.value.detail_img_last,"onUpdate:url":t[8]||(t[8]=s=>e.value.detail_img_last=s),max:10,width:80,height:80},null,8,["url"]),Ae])]),_:1})):g("",!0),e.value.type=="associated_goods"?(n(),h(_,{key:5},{default:o(()=>[a("div",Je,[Pe,d.value.length!=0?(n(),V("div",Ye,[l(M(fe),{modelValue:d.value,"onUpdate:modelValue":t[9]||(t[9]=s=>d.value=s),onEnd:A},{item:o(({element:s,index:le})=>[l(ee,{onDeleteItem:ct=>L(le)},{default:o(()=>[a("div",Fe,[a("img",{class:"goods-img flex-g0 flex-s0",src:s.goods_thumb_img||s.thumb_img},null,8,Le),a("div",We,[l(Z,{width:200,trigger:"hover"},{reference:o(()=>[a("div",Ke,m(s.goods_title||s.title),1)]),default:o(()=>[a("div",null,m(s.goods_title||s.title),1)]),_:2},1024),a("div",Qe,[a("div",null,m(s.goods_score||s.score)+" \u79EF\u5206",1),a("div",null,m(s.sale_status=="on_sale"?"\u5DF2\u4E0A\u67B6":"\u5DF2\u4E0B\u67B6"),1)])])])]),_:2},1032,["onDeleteItem"])]),_:1},8,["modelValue"])])):g("",!0),l(x,{type:"primary",style:{width:"100%"},disabled:d.value.length>100,onClick:t[10]||(t[10]=s=>W())},{default:o(()=>[Xe,Ze]),_:1},8,["disabled"])])]),_:1})):g("",!0),a("div",et,[a("div",tt,[l(x,{type:"default",size:"small",onClick:O},{default:o(()=>[at]),_:1}),l(x,{type:"primary",size:"small",onClick:H},{default:o(()=>[st]),_:1})])])]),_:1},8,["model","rules"])]),_:1}),l(se,{modelValue:w.value,"onUpdate:modelValue":t[11]||(t[11]=s=>w.value=s),title:"\u6DFB\u52A0\u5546\u54C1",width:"83%",top:"3vh","before-close":B},{footer:o(()=>[a("span",lt,[ot,a("span",it,m(q.value.length),1),dt]),a("span",nt,[l(x,{size:"small",onClick:B},{default:o(()=>[rt]),_:1}),l(x,{type:"primary",size:"small",onClick:F},{default:o(()=>[_t]),_:1})])]),default:o(()=>[l(he,{"echo-select-goods":j.value,"click-edit":U.value,onSelectGoods:Y},null,8,["echo-select-goods","click-edit"])]),_:1},8,["modelValue"])])])}}};var xt=N(ut,[["__scopeId","data-v-1ab297ea"]]);export{xt as default};
