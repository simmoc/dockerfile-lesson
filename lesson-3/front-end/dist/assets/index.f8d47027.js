
/**
 * 由 Fantastic-admin 提供技术支持
 * https://hooray.gitee.io/fantastic-admin/
 * Powered by Fantastic-admin
 * https://hooray.github.io/fantastic-admin/
 */
    
import{_ as x}from"./index.a5dee889.js";import{r as u,a as c,q as d,t as i,A as _,c as S,J as p,y as r,z as n,R as g,S as f,C as y,D as w,F as V,G as L}from"./vendor.d2559d84.js";import{b as N,H as T}from"./index.94e839d6.js";import{_ as q}from"./plugin-vue_export-helper.21dcd24c.js";const D={goods_title:"CustomerSelect",components:{customerTag:x},props:{modelValue:{type:Object},treeData:{type:Array,default:()=>[]},editSelectList:{type:Array,default:()=>[]},shopNameClose:{type:Boolean,default:!1}},emits:["update:modelValue"],data(){return{expand:!1,leafShow:!1,selectList:[],searchContent:"",searchTreeData:[],hq_list:[],leafNode:{},radioCheck:{goods_class_id:0,name:"",checkGoods:{}}}},computed:{},watch:{treeData:{handler(e){let s=JSON.parse(JSON.stringify(e));this.initSetChecked(s,0),this.$route.query.sale_script_id&&this.getLeafData(s[0].childrens[0])},deep:!0},shopNameClose:{handler(){this.closeTag()}}},mounted(){let e=this;document.body.addEventListener("click",function(s){let o=document.getElementsByClassName("customer-select")[0];s.path.includes(o)?e.expand=!0:e.expand=!1})},created(){this.getTagSearch()},methods:{search:N(function(e){console.log(e),this.getTagSearch(e)}),async getTagSearch(e){let{data:s}=await T.getOrderStoreGoods({search_goods_name:e});if(e){let o=[];s&&(s.length>0&&s.forEach(a=>{a.goods_list&&a.goods_list.forEach(t=>{o.push({label:`${a.name}/${t.goods_title}`,goods_id:t.goods_id,goods_title:t.goods_title,name:a.name,checked:!1})})}),this.selectList.length>0&&this.selectList.forEach(a=>{o.forEach(t=>{a.goods_id===t.goods_id&&(t.checked=!0)})}),this.searchTreeData=o)}else this.hq_list=s,this.selectList.forEach(o=>{this.changeChecked(this.hq_list,o.goods_id,!0)}),this.selectList.forEach(o=>{this.changeChecked(this.selectList,o.goods_id,!0)}),this.selectList.forEach(o=>{this.hq_list.forEach(a=>{o.name===a.name&&(a.checked=!0)})})},closeTag(){this.hq_list.forEach(e=>{e.checked=!1}),this.radioCheck={name:"",goods_class_id:"",checkGoods:{goods_title:""}},this.$emit("update:modelValue",this.radioCheck)},async getChecked(){await this.selectedParentChecked(),console.log("this.selectList",this.radioCheck),this.$emit("update:modelValue",this.radioCheck)},selectedParentChecked(){return this.hq_list.forEach(e=>{e.checked=!1}),this.hq_list.forEach(e=>{this.radioCheck.checkGoods.goods_class_id===e.goods_class_id&&(this.radioCheck.goods_class_id=e.goods_class_id,this.radioCheck.name=e.name,e.checked=!0)}),this.radioCheck.goods_class_id||(this.radioCheck.name=this.radioCheck.checkGoods.name),Promise.resolve(!0)},getLeafData(e){this.initSetExpand(this.hq_list,!1),e.expand=!0,this.leafNode={name:e.name,goods_list:e.goods_list}},initSetExpand(e,s){e.forEach(o=>{o.expand=!1,o.goods_list&&o.goods_list.length>0&&this.initSetExpand(o.goods_list,s)})},initSetChecked(e,s){e.forEach(o=>{o.expand=!1,s===0&&(o.expand=!0),o.childrens&&o.childrens.length>0?this.initSetChecked(o.childrens,s+1):o.checked=!1})},getNodeKey(e,s,o){let a="";return e.forEach((t,h)=>{t[o]===s&&(a=h),t.childrens&&t.childrens.length>0&&this.getNodeKey(t.childrens,s,o)}),a},changeChecked(e,s,o,a="goods_id"){e.forEach(t=>{t[a]===s?t.checked=o:t.goods_list&&t.goods_list.length>0&&this.changeChecked(t.goods_list,s,o)})}}},G=e=>(V("data-v-86f8bbfa"),e=e(),L(),e),j={class:"customer-select"},B={key:0,class:"customer-placeholder"},I={class:"el-input__suffix"},O={class:"el-input__suffix-inner"},z={key:0,class:"select-content"},A={class:"select-bg"},J={key:0,class:"select-main"},P={class:"select-ul"},U=G(()=>i("div",{class:"head-level"},"\u5546\u54C1\u5206\u7C7B",-1)),F=["onClick"],H={class:"zw-content"},K={class:"leaf-goods_title"},M={key:1,class:"select-search-main"},R={key:0,class:"select-search-ul"},Q={class:"member-goods_title"},W={class:"member-goods_title overflow-ellipsis"},X={key:1};function Y(e,s,o,a,t,h){const v=x,E=u("el-input"),k=u("el-popover"),m=u("el-radio"),C=u("el-radio-group"),b=u("el-collapse-transition");return c(),d("div",j,[i("div",null,[i("div",{class:"customer-input flex flex-align-center",onClick:s[1]||(s[1]=l=>t.expand=!t.expand)},[t.radioCheck.name?(c(),S(v,{key:1,"left-title":t.radioCheck.name,"right-title":t.radioCheck.checkGoods.goods_title,"show-close":!0,color:"#409eff","customer-style":{"margin-bottom":"10px"},onCloseTag:s[0]||(s[0]=l=>h.closeTag())},null,8,["left-title","right-title"])):(c(),d("span",B," \u8BF7\u9009\u62E9\u5546\u54C1"+_(e.treeChecked),1))]),i("span",I,[i("span",O,[i("i",{class:p(["el-select__caret el-input__icon el-icon-arrow-down",{expand:t.expand}])},null,2)])])]),r(b,null,{default:n(()=>[t.expand?(c(),d("div",z,[i("div",A,[r(E,{modelValue:t.searchContent,"onUpdate:modelValue":s[2]||(s[2]=l=>t.searchContent=l),class:"select-search",placeholder:"\u8BF7\u8F93\u5165",onInput:s[3]||(s[3]=l=>h.search(l))},null,8,["modelValue"]),t.searchContent?(c(),d("div",M,[t.searchTreeData.length>0?(c(),d("ul",R,[r(C,{modelValue:t.radioCheck.checkGoods,"onUpdate:modelValue":s[6]||(s[6]=l=>t.radioCheck.checkGoods=l),onChange:s[7]||(s[7]=l=>h.getChecked())},{default:n(()=>[(c(!0),d(g,null,f(t.searchTreeData,l=>(c(),d("li",{key:l.id},[r(m,{label:l},{default:n(()=>[r(k,{width:210,trigger:"click"},{reference:n(()=>[i("span",W,_(l.label),1)]),default:n(()=>[i("span",Q,_(l.label),1)]),_:2},1024)]),_:2},1032,["label"])]))),128))]),_:1},8,["modelValue"])])):(c(),d("div",X,"\u6682\u65E0\u6570\u636E"))])):(c(),d("div",J,[i("ul",P,[i("li",null,[U,i("ul",null,[(c(!0),d(g,null,f(t.hq_list,l=>(c(),d("li",{key:l.goods_class_id,class:"flex flex-justify-between flex-align-center tag-group",onClick:y(Z=>h.getLeafData(l),["stop"])},[i("span",{class:p(["tag-goods_title",{"tag-goods_title-active":l.checked}])},_(l.name),3),i("i",{class:p(["el-icon-arrow-right",{"tag-checked":l.checked}])},null,2)],8,F))),128))])])]),i("ul",H,[r(C,{modelValue:t.radioCheck.checkGoods,"onUpdate:modelValue":s[5]||(s[5]=l=>t.radioCheck.checkGoods=l),onChange:h.getChecked},{default:n(()=>[(c(!0),d(g,null,f(t.leafNode.goods_list,l=>(c(),d("li",{key:l.goods_id,onClick:s[4]||(s[4]=y(()=>{},["stop"]))},[r(m,{label:l},{default:n(()=>[r(k,{width:210,trigger:"click"},{reference:n(()=>[i("span",{class:p(["leaf-goods_title overflow-ellipsis",{"leaf-goods_title-active":l.checked}])},_(l.goods_title),3)]),default:n(()=>[i("span",K,_(l.goods_title),1)]),_:2},1024)]),_:2},1032,["label"])]))),128))]),_:1},8,["modelValue","onChange"])])]))])])):w("",!0)]),_:1})])}var oe=q(D,[["render",Y],["__scopeId","data-v-86f8bbfa"]]);export{oe as _};
