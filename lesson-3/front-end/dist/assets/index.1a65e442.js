
/**
 * 由 Fantastic-admin 提供技术支持
 * https://hooray.gitee.io/fantastic-admin/
 * Powered by Fantastic-admin
 * https://hooray.github.io/fantastic-admin/
 */
    
var E=Object.defineProperty,q=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var h=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var v=(m,e,s)=>e in m?E(m,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):m[e]=s,x=(m,e)=>{for(var s in e||(e={}))G.call(e,s)&&v(m,s,e[s]);if(h)for(var s of h(e))J.call(e,s)&&v(m,s,e[s]);return m},k=(m,e)=>q(m,Q(e));import{_ as K}from"./index.fece4a24.js";import{_ as P}from"./index.333b158c.js";import{_ as W}from"./index.f1e12eef.js";import{H as y}from"./index.94e839d6.js";import{Q as X,M as Z,o as ee,a6 as w,h as j,r as _,a as f,q as z,t as i,y as c,L as o,z as d,R as te,S as ae,c as C,A as S,D as oe,H as D,E as ne}from"./vendor.d2559d84.js";import{_ as le}from"./select-member.d05cd3eb.js";import{_ as se}from"./plugin-vue_export-helper.21dcd24c.js";import"./contant.2e72a177.js";import"./error.32433a76.js";import"./tick@2x.1e6bc440.js";import"./vuedraggable.umd.56963d08.js";import"./sortable.esm.81321d43.js";const re={class:"search-form"},ie={class:"search-head-wrap flex flex-justify-between bg-color-fff p-24"},ce={class:"search-head-left flex-1"},me={class:"search-head-right"},de=D("\u91CD\u7F6E"),_e=D(" \u67E5\u8BE2 "),pe={class:"event-task-overview-page search-table-page flex flex-direction-column"},ue={class:"content-wrap flex flex-direction-column flex-1"},fe={class:"flex-1 flex flex-direction-column content-main-right"},be={class:"table-head flex flex-justify-between"},ge={class:"table-head-left overflow-ellipsis"},he={class:"table-head-left-text"},ve={class:"table-head-left-text"},xe={class:"table-body content-main-right-table-body"},ke={class:"flex flex-align-center color-primary"},ye={class:"table-pagination-wrap flex flex-justify-end"},we={setup(m){const e=X({search:{create_time:"",sendor:"",task_id:""},taskLoading:!1,taskOption:[],tableData:[],pageSize:10,pageNo:1,pageSizes:[10,15,20],totalNo:0,param:{},touchRate:0,customerCount:0,writeBackSelectedMemberOrg:[],customInputValueFn:a=>V(a,3)||"",tableTitle:[{label:"\u6210\u5458\u540D\u79F0",prop:"member_name",type:"slot"},{label:"\u4EFB\u52A1\u540D\u79F0",prop:"name"},{label:"\u4EFB\u52A1\u751F\u6210\u65F6\u95F4",prop:"create_time_F"},{label:"\u6267\u884C\u72B6\u6001",prop:"is_execute_txt"},{label:"\u6267\u884C\u65F6\u95F4",prop:"receive_time_F"},{label:"\u76EE\u6807\u5BA2\u6237",prop:"customer_name"}]}),s=Z(null);ee(()=>{b(),p()});function M(a,t){const r=200;return t>=r?(ne({message:`\u6700\u591A\u652F\u6301\u5BA2\u6237\u4EBA\u6570${r}\u4EBA`,type:"error"}),!1):!0}function V(a,t){return`${a.slice(0,t).map(r=>r.member_name||r.department_name).join("\uFF0C")}${a.length>t?"...":""}`}function N(a){e.writeBackSelectedMemberOrg=a;var t=[],r=[];a&&Array.isArray(a)&&(a.map(n=>{n.isOrg?r.push(n.id):t.push(n.id)}),e.search.department_id=r.join(","),e.search.member_id=t.join(","),e.search.member_arr=a,u()),s&&(s.value.dialogVisible=!1)}function b(a){console.log("search",a),e.taskLoading=!0;let t={keyword:a};setTimeout(()=>{e.taskLoading=!1,y.getTaskAllList(t).then(r=>{e.taskOption=r.data,w(()=>{})}).catch(()=>{})},2e3)}function p(){let a=k(x({},e.search),{page_no:e.pageNo,page_size:e.pageSize});console.log("table \u53C2\u6570===",a),y.getOverviewList(a).then(t=>{console.log(t.data);let r=t.data&&t.data.list;e.totalNo=t.data&&t.data.count,e.touchRate=t.data&&t.data.touch_rate,e.customerCount=t.data&&t.data.customer_count,e.tableData=r.map(n=>(n.create_time?n.create_time_F=j(n.create_time).format("MM-DD HH:mm"):n.create_time_F="-",n.receive_time?n.receive_time_F=j(n.receive_time).format("MM-DD HH:mm"):n.receive_time_F="-",n)),w(()=>{})}).catch(()=>{})}function F(a){e.pageSize=a,e.pageNo=1,p()}function H(a){e.pageNo=a,p()}function u(){p()}function O(){e.search={subject_id:"",event_name:"",event_key:""},e.writeBackSelectedMemberOrg=[],p()}return(a,t)=>{const r=_("el-date-picker"),n=_("el-form-item"),T=_("el-input"),L=_("el-option"),B=_("el-select"),R=_("el-form"),g=_("el-button"),$=K,A=P,I=_("el-pagination"),U=W;return f(),z("div",null,[i("div",re,[i("div",ie,[i("div",ce,[c(R,{"label-position":"left",inline:!0,model:o(e).search,size:"mini",class:"search-form-inline","label-width":"auto"},{default:d(()=>[c(n,{label:"\u4EFB\u52A1\u751F\u6210\u65F6\u95F4\uFF1A",class:"mr24 mb24"},{default:d(()=>[c(r,{modelValue:o(e).search.create_time,"onUpdate:modelValue":t[0]||(t[0]=l=>o(e).search.create_time=l),"value-format":"YYYY-MM-DD HH:mm:ss",type:"datetimerange","range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F",align:"right",style:{width:"320px"},onChange:u},null,8,["modelValue"])]),_:1}),c(n,{label:"\u6267\u884C\u6210\u5458\uFF1A",class:"mr24 mb24"},{default:d(()=>[c(le,{ref_key:"addMemberDialogRef",ref:s,"input-placeholder":"\u8BF7\u9009\u62E9","write-back-selected-member-org":o(e).writeBackSelectedMemberOrg,"is-multiple-selected":!0,"custom-input-value-fn":o(e).customInputValueFn,"custom-selected-fn":M,style:{width:"200px"},onConfirm:N},{default:d(l=>[c(T,{modelValue:l.data,"onUpdate:modelValue":Y=>l.data=Y,placeholder:"\u8BF7\u9009\u62E9","suffix-icon":"el-icon-arrow-down",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["write-back-selected-member-org","custom-input-value-fn"])]),_:1}),c(n,{label:"\u4EFB\u52A1\u540D\u79F0\uFF1A",class:"mr24 mb24"},{default:d(()=>[c(B,{modelValue:o(e).search.task_id,"onUpdate:modelValue":t[1]||(t[1]=l=>o(e).search.task_id=l),placeholder:"\u8BF7\u9009\u62E9",size:"mini",multiple:"",filterable:"",remote:"","collapse-tags":"",loading:o(e).taskLoading,"remote-method":b,class:"select-task",onChange:u},{default:d(()=>[(f(!0),z(te,null,ae(o(e).taskOption,l=>(f(),C(L,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1})]),_:1},8,["model"])]),i("div",me,[c(g,{size:"mini",onClick:O},{default:d(()=>[de]),_:1}),c(g,{type:"primary",size:"mini",onClick:u},{default:d(()=>[_e]),_:1})])])]),c(U,null,{default:d(()=>[i("div",pe,[i("div",ue,[i("div",fe,[i("div",be,[i("div",ge,[i("span",he,"\u9001\u8FBE\u7387\uFF1A"+S(o(e).touchRate),1),i("span",ve," \u76EE\u6807\u5BA2\u6237\u6570\uFF1A"+S(o(e).customerCount),1)])]),i("div",xe,[c(A,{"table-title":o(e).tableTitle,"table-data":o(e).tableData,"need-pagination":!0},{member_name:d(l=>[i("div",ke,[c($,{class:"table-member-card","member-id":l.data.member_id,avatar:l.data.member_avatar,name:l.data.member_name,"department-name":l.data.member_department},null,8,["member-id","avatar","name","department-name"])])]),_:1},8,["table-title","table-data"])]),i("div",ye,[o(e).tableData.length?(f(),C(I,{key:0,"current-page":o(e).pageNo,"page-sizes":o(e).pageSizes,"page-size":o(e).pageSize,layout:"total, sizes, prev, pager, next, jumper",total:o(e).totalNo,onSizeChange:F,onCurrentChange:H},null,8,["current-page","page-sizes","page-size","total"])):oe("",!0)])])])])]),_:1})])}}};var Be=se(we,[["__scopeId","data-v-7d765f22"]]);export{Be as default};
