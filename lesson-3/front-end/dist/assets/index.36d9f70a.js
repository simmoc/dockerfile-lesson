
/**
 * 由 Fantastic-admin 提供技术支持
 * https://hooray.gitee.io/fantastic-admin/
 * Powered by Fantastic-admin
 * https://hooray.github.io/fantastic-admin/
 */
    
import{_ as ie}from"./index.333b158c.js";import{_ as de}from"./index.6ba23372.js";import{_ as re}from"./index.f1e12eef.js";import{_ as _e}from"./index.5931791c.js";import{a as ue}from"./drag.56588ea6.js";import{H as T}from"./index.94e839d6.js";import{S as ce}from"./sortable.esm.81321d43.js";import{P as me,M as i,o as pe,r as m,a as r,q as _,t as o,y as a,z as s,R as ge,S as ve,c as fe,A as x,H as v,D as $,J as he,F as be,G as we,E as k}from"./vendor.d2559d84.js";import{_ as ye}from"./plugin-vue_export-helper.21dcd24c.js";const h=C=>(be("data-v-412b3268"),C=C(),we(),C),xe={class:"rotation-box"},ke={class:"search-form"},Ce=v("\u91CD\u7F6E"),De=v("\u67E5\u8BE2"),Ve={class:"flex flex-align-center flex-justify-between"},Se=h(()=>o("div",{class:"explain-test"},"\u8F6E\u64AD\u56FE\u7BA1\u7406\u5217\u8868",-1)),je=h(()=>o("i",{class:"el-icon-plus mr8"},null,-1)),Be=v(" \u6DFB\u52A0\u8F6E\u64AD\u56FE "),ze={class:"can-drag-icon flex flex-align-center flex-space-center",style:{height:"50px"}},Te=["data-sort"],$e=h(()=>o("br",null,null,-1)),Ie={class:"goods-img"},Ne=["src","onClick"],Ye={key:0,class:"flex flex-align-end"},He={class:"goods-img"},Me=["src","onClick"],Ee={key:0,class:"ml6"},Oe={key:1},Ue={key:0,class:"flex flex-align-end"},Je={class:"goods-img"},Re=["src","onClick"],Ae={key:0,class:"ml6"},Le={key:1},Pe=v(" \u7F16\u8F91 "),qe=v(" \u5220\u9664 "),Fe=h(()=>o("i",{class:"el-icon-arrow-left"},null,-1)),Ge=[Fe],Ke={class:"image-box"},Qe=["src"],We=h(()=>o("i",{class:"el-icon-arrow-right"},null,-1)),Xe=[We],Ze=h(()=>o("div",{class:"group_name"},"\u662F\u5426\u5220\u9664\u8BE5\u8F6E\u64AD\u56FE",-1)),et={setup(C){const L=me(),n=i({page:1,page_size:10,name:"",type:"",start_time_s:"",start_time_e:"",end_time_s:"",end_time_e:""}),H=i([new Date(2e3,1,1,0,0,0),new Date(2e3,2,1,23,59,59)]),M=i(0),D=i([]),V=i([]),E=i([]),b=i([]),p=i([]),w=i(0),I=i(!1),O=i([]),S=i(!1),U=i(null),P=()=>{D.value=[],V.value=[],n.value={},Y(!1),f()},q=()=>{Y(!0),f()},f=async()=>{let{data:t}=await T.getBannerList(n.value);b.value=t.list,M.value=t.total_num,console.log("tableData.value",b.value)},F=t=>({associated_mini_program:"\u5173\u8054\u5C0F\u7A0B\u5E8F",associated_goods:"\u5173\u8054\u5546\u54C1",not_associated_goods:"\u4E0D\u5173\u8054\u5546\u54C1"})[t],G=async()=>{let{data:t}=await T.getBannertype();E.value=t},K=()=>{I.value=!1},N=t=>{p.value=[],typeof t=="string"?p.value[0]=t:p.value=t,w.value=0,I.value=!0},J=t=>{if(w.value==0&&t==-1){k.warning("\u5DF2\u7ECF\u662F\u7B2C\u4E00\u5F20");return}else if(w.value==p.value.length-1&&t==1){k.warning("\u5DF2\u7ECF\u662F\u6700\u540E\u4E00\u5F20");return}w.value+=t},R=(t,l,d)=>{if(t&&t[0]){n.value[l]=t[0],n.value[d]=t[1];return}n.value[l]="",n.value[d]=""},Q=async()=>{let{code:t,msg:l}=await T.updateBannerSort({banner_data:O.value});if(t==200){k.success({message:"\u64CD\u4F5C\u6210\u529F"}),b.value=[],f();return}k.warning({message:l})},Y=t=>{const l=document.querySelectorAll(".el-table__body-wrapper > table > tbody")[0];ce.create(l,{disabled:t,ghostClass:"sortable-ghost",handle:".can-drag-icon",setData:function(d){d.setData("Text","")},onEnd:({newIndex:d,oldIndex:u})=>{let j=[],y=JSON.parse(JSON.stringify(b.value));y=W(y,d,u),y.forEach((B,g)=>{j.push({id:B.id,sort:100-g})}),O.value=j,Q()}})};function W(t,l,d){let u=JSON.parse(JSON.stringify(t[d]));return t.splice(d,1),t.splice(l,0,u),t}const A=(t,l)=>{L.push({name:t,query:l})},X=()=>{S.value=!1},Z=t=>{U.value=t,S.value=!0},ee=async()=>{(await T.deleteBanner({id:U.value})).code===200&&(k.success({message:"\u5DF2\u5220\u9664\u8BE5\u8F6E\u64AD\u56FE!"}),S.value=!1,f())};return pe(()=>{f(),G(),Y(!1)}),(t,l)=>{const d=m("el-input"),u=m("el-form-item"),j=m("el-option"),y=m("el-select"),B=m("el-date-picker"),g=m("el-button"),te=m("el-form"),c=m("el-table-column"),le=ie,ae=de,se=re,oe=m("el-dialog"),ne=_e;return r(),_("div",xe,[o("div",ke,[a(te,{"label-width":"150px",inline:!0,size:"small",model:n.value,class:"clearfix"},{default:s(()=>[a(u,{label:"\u8F6E\u64AD\u56FE\u540D\u79F0\uFF1A",class:"mr20"},{default:s(()=>[a(d,{modelValue:n.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>n.value.name=e),placeholder:"\u8BF7\u8F93\u5165\u8F6E\u64AD\u56FE\u540D\u79F0",class:"width-class"},null,8,["modelValue"])]),_:1}),a(u,{label:"\u8F6E\u64AD\u56FE\u7C7B\u578B\uFF1A",class:"mr20"},{default:s(()=>[a(y,{modelValue:n.value.type,"onUpdate:modelValue":l[1]||(l[1]=e=>n.value.type=e),placeholder:"\u8BF7\u9009\u62E9\u8F6E\u64AD\u56FE\u7C7B\u578B",class:"width-class"},{default:s(()=>[(r(!0),_(ge,null,ve(E.value,e=>(r(),fe(j,{key:e.key,label:e.value,value:e.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"\u8F6E\u64AD\u56FE\u5F00\u59CB\u65F6\u95F4\uFF1A",class:"mr20"},{default:s(()=>[a(B,{modelValue:D.value,"onUpdate:modelValue":l[2]||(l[2]=e=>D.value=e),type:"daterange","range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65F6\u95F4","end-placeholder":"\u7ED3\u675F\u65F6\u95F4","value-format":"YYYY-MM-DD HH:mm:ss","default-time":H.value,onChange:l[3]||(l[3]=e=>R(D.value,"start_time_s","start_time_e"))},null,8,["modelValue","default-time"])]),_:1}),a(u,{label:"\u8F6E\u64AD\u56FE\u7ED3\u675F\u65F6\u95F4\uFF1A",class:"mr20"},{default:s(()=>[a(B,{modelValue:V.value,"onUpdate:modelValue":l[4]||(l[4]=e=>V.value=e),type:"daterange","range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65F6\u95F4","end-placeholder":"\u7ED3\u675F\u65F6\u95F4","value-format":"YYYY-MM-DD HH:mm:ss","default-time":H.value,onChange:l[5]||(l[5]=e=>R(V.value,"end_time_s","end_time_e"))},null,8,["modelValue","default-time"])]),_:1}),a(u,{class:"right mr0"},{default:s(()=>[a(g,{type:"default",size:"small",onClick:P},{default:s(()=>[Ce]),_:1}),a(g,{type:"primary",size:"small",onClick:q},{default:s(()=>[De]),_:1})]),_:1})]),_:1},8,["model"])]),a(se,{class:"rotation-list"},{default:s(()=>[o("div",Ve,[Se,a(g,{type:"primary",size:"small",onClick:l[6]||(l[6]=e=>A("addRotation",{pageType:"add"}))},{default:s(()=>[je,Be]),_:1})]),a(le,{"table-data":b.value,"need-pagination":!0,class:"order-table"},{default:s(()=>[a(c,{label:"\u6392\u5E8F","min-width":"60"},{default:s(e=>[o("div",ze,[o("img",{style:{width:"12px",height:"12px","margin-left":"8px","vertical-align":"middle"},src:ue,"data-sort":e.row.sort,alt:""},null,8,Te)])]),_:1}),a(c,{label:"\u8F6E\u64AD\u56FE\u540D\u79F0","min-width":"350"},{default:s(e=>[o("div",null,x(e.row.name),1)]),_:1}),a(c,{label:"\u8F6E\u64AD\u56FE\u7C7B\u578B","min-width":"200"},{default:s(e=>[o("div",null,x(F(e.row.type)),1)]),_:1}),a(c,{label:"\u8F6E\u64AD\u56FE\u5C55\u793A\u65F6\u95F4","min-width":"240"},{default:s(e=>[o("div",null,[v(x(e.row.start_time)+" \u81F3 ",1),$e,v(" "+x(e.row.end_time),1)])]),_:1}),a(c,{label:"\u9996\u9875\u8F6E\u64AD\u56FE","min-width":"110"},{default:s(e=>[o("div",Ie,[o("img",{src:e.row.banner_img,alt:"\u8F6E\u64AD\u56FE\u9996\u9875",onClick:z=>N(e.row.banner_img)},null,8,Ne)])]),_:1}),a(c,{label:"\u5173\u8054\u5C0F\u7A0B\u5E8F","min-width":"170"},{default:s(e=>[o("div",null,x(e.row.mini_program_title||"\u2014"),1)]),_:1}),a(c,{label:"\u8BE6\u60C5\u9875\u9996\u56FE","min-width":"162"},{default:s(e=>[e.row.detail_img_first&&e.row.detail_img_first[0]?(r(),_("div",Ye,[o("div",He,[o("img",{src:e.row.detail_img_first[0],alt:"\u8BE6\u60C5\u9875\u9996\u56FE",onClick:z=>N(e.row.detail_img_first)},null,8,Me)]),e.row.detail_img_first.length>1?(r(),_("div",Ee,"...")):$("",!0)])):(r(),_("div",Oe,"\u2014"))]),_:1}),a(c,{label:"\u8BE6\u60C5\u9875\u5C3E\u56FE","min-width":"110"},{default:s(e=>[e.row.detail_img_last&&e.row.detail_img_last[0]?(r(),_("div",Ue,[o("div",Je,[o("img",{src:e.row.detail_img_last[0],alt:"\u8BE6\u60C5\u9875\u5C3E\u56FE",onClick:z=>N(e.row.detail_img_last)},null,8,Re)]),e.row.detail_img_last.length>1?(r(),_("div",Ae,"...")):$("",!0)])):(r(),_("div",Le,"\u2014"))]),_:1}),a(c,{label:"\u64CD\u4F5C",prop:"",fixed:"right",width:"100"},{default:s(({row:e})=>[a(g,{type:"text",size:"mini",onClick:z=>A("editRotation",{banner_id:e.banner_id,pageType:"edit"})},{default:s(()=>[Pe]),_:2},1032,["onClick"]),a(g,{type:"text",size:"mini",onClick:z=>Z(e.banner_id)},{default:s(()=>[qe]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["table-data"]),a(ae,{limit:n.value.page_size,"onUpdate:limit":l[7]||(l[7]=e=>n.value.page_size=e),page:n.value.page,"onUpdate:page":l[8]||(l[8]=e=>n.value.page=e),total:M.value,"get-data":f},null,8,["limit","page","total"])]),_:1}),a(oe,{"model-value":I.value,title:"\u56FE\u7247\u9884\u89C8","custom-class":"sop-add-other-content-dialog",width:"960px","close-on-click-modal":!1,"close-on-press-escape":!1,onClose:K},{default:s(()=>[o("div",{class:he(["image-dialog flex flex-align-center",[p.value.length>1?"flex-justify-between":"flex-justify-center"]])},[p.value.length>1?(r(),_("div",{key:0,class:"image-dialog-circular tc",onClick:l[9]||(l[9]=e=>J(-1))},Ge)):$("",!0),o("div",Ke,[o("img",{src:p.value[w.value],alt:""},null,8,Qe)]),p.value.length>1?(r(),_("div",{key:1,class:"image-dialog-circular tc",onClick:l[10]||(l[10]=e=>J(1))},Xe)):$("",!0)],2)]),_:1},8,["model-value"]),a(ne,{title:"\u63D0\u793A","dialog-visible":S.value,width:"450px","confirm-fn":ee,onCancel:X},{default:s(()=>[Ze]),_:1},8,["dialog-visible"])])}}};var _t=ye(et,[["__scopeId","data-v-412b3268"]]);export{_t as default};
