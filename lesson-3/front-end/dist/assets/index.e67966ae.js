
/**
 * 由 Fantastic-admin 提供技术支持
 * https://hooray.gitee.io/fantastic-admin/
 * Powered by Fantastic-admin
 * https://hooray.github.io/fantastic-admin/
 */
    
import{_ as L,a as G,b as P,c as F,d as K,e as O,f as $,g as J,h as Q}from"./write.74214fac.js";import{_ as Z}from"./index.333b158c.js";import{_ as W}from"./index.f1e12eef.js";import{O as X,Q as ee,o as ae,a6 as x,r as _,a as i,q as f,t as n,A as p,L as l,y as r,z as d,c as u,B as te,D as g,F as le,G as se,R as I,S,J as oe,H as y}from"./vendor.d2559d84.js";import{H as T}from"./index.94e839d6.js";import{_ as ne}from"./plugin-vue_export-helper.21dcd24c.js";const ie=b=>(le("data-v-09cae71d"),b=b(),se(),b),de={class:"search-form"},_e={class:"head"},ce={class:"head-r2 mb24"},re={class:"search-bar"},pe={class:"search-field-item"},ue=ie(()=>n("div",{class:"search-field-item-label"},"\u641C\u7D22\u8981\u7D20\uFF1A",-1)),ge={class:"search-btn-group"},me=y("\u91CD\u7F6E"),fe=y(" \u67E5\u8BE2 "),be={class:"page event-record-page only-table-page flex flex-direction-column"},he={class:"content-wrap p-24"},ve={class:"table-body content-main-right-table-body"},ye={class:"flex flex-align-center"},Te={key:0,class:"icon-in-td flex-row flex-align-center"},we=["src"],ke=["onClick"],xe={class:"table-pagination-wrap flex flex-justify-end"},Ie={class:"table-column-name-text"},Se={setup(b){function V(s){return new URL({"../../../../assets/images/eventManage/BUSINESS.svg":L,"../../../../assets/images/eventManage/THIRD.svg":G,"../../../../assets/images/eventManage/YOUZAN.svg":P,"../../../../assets/images/eventManage/addGroup.svg":F,"../../../../assets/images/eventManage/addInGroup.svg":K,"../../../../assets/images/eventManage/addItem.svg":O,"../../../../assets/images/eventManage/doc_code.svg":$,"../../../../assets/images/eventManage/minusInGroup.svg":J,"../../../../assets/images/eventManage/write.svg":Q}[`../../../../assets/images/eventManage/${s}.svg`],self.location).href}const m=X(),e=ee({id:"",name:"",key:"",tableData:[],tableCol:[],pageSize:10,pageNo:1,pageSizes:[10,15,20],totalNo:0,search:{},subjectfields:[],fieldId:"",fieldValue:"",fieldShowType:"INPUT",dialogVisible:!1,dialogTime:"",dialogTableData:[]});ae(()=>{e.id=m&&m.query&&m.query.id,j()});function D(){e.fieldValue=e.fieldShowType==="DATETIME"?["",""]:"",c()}async function C(s,t){s.is_subject&&t[s.field]&&t[s.field]!="\u2014"&&z(t.id,s.subject_id)}async function z(s,t){let o={events_happen_id:s,subject_id:t};await T.getSnapshot(o).then(h=>{e.dialogTime=h.data.create_time,e.dialogTableData=h.data.data_snap,e.dialogVisible=!0}).catch(()=>{})}function M(s){let[t]=e.subjectfields.filter(o=>o.element_key===s);t&&t.element_type==="DATETIME"?(e.fieldShowType="DATETIME",e.fieldValue=["",""]):(e.fieldShowType="INPUT",e.fieldValue=""),c()}function j(){let s={events_id:e.id};console.log("\u8981\u7D20\u53C2\u6570======",s),T.getElementList(s).then(t=>{e.subjectfields=t.data,e.fieldId=e.subjectfields[0].element_key,e.subjectfields[0]&&e.subjectfields[0].element_type==="DATETIME"?e.fieldShowType="DATETIME":e.fieldShowType="INPUT",c(),x(()=>{})}).catch(()=>{})}function c(){let s={events_id:e.id},t=e.subjectfields.filter(o=>{if(o.element_key===e.fieldId)return o.keyword=e.fieldValue,!0});t&&t.length&&(s={events_id:m.query&&m.query.id,elements_info:t[0],page_size:e.pageSize,page_no:e.pageNo}),console.log("\u8868\u683C\u53C2\u6570======",s),T.getHistoryList(s).then(o=>{console.log(o.data),e.tableData=o.data&&o.data.table_data.list,console.log("ReacData.tableData",e.tableData),e.totalNo=o.data&&o.data.table_data.count,e.name=o.data.event_name,e.key=o.data.event_key,e.tableCol=o.data.table_th,x(()=>{})}).catch(()=>{})}function N(s){e.pageSize=s,e.pageNo=1,c()}function E(s){e.pageNo=s,c()}return(s,t)=>{const o=_("el-option"),h=_("el-select"),U=_("el-input"),H=_("el-date-picker"),w=_("el-button"),v=_("el-table-column"),A=Z,Y=_("el-pagination"),B=_("el-table"),R=_("el-dialog"),q=W;return i(),f("div",null,[n("div",de,[n("div",_e,[n("div",ce,"\u4E8B\u4EF6\u6807\u8BC6\uFF1A"+p(l(e).key),1),n("div",re,[n("div",pe,[ue,r(h,{modelValue:l(e).fieldId,"onUpdate:modelValue":t[0]||(t[0]=a=>l(e).fieldId=a),class:"search-field-id",style:{width:"170px"},size:"mini",onChange:M},{default:d(()=>[(i(!0),f(I,null,S(l(e).subjectfields,a=>(i(),u(o,{key:a.element_key,label:a.element_name,value:a.element_key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(e).fieldShowType==="INPUT"?(i(),u(U,{key:0,modelValue:l(e).fieldValue,"onUpdate:modelValue":t[1]||(t[1]=a=>l(e).fieldValue=a),class:"search-field-value",size:"mini",onKeyup:te(c,["enter"])},null,8,["modelValue","onKeyup"])):g("",!0),l(e).fieldShowType==="DATETIME"?(i(),u(H,{key:1,modelValue:l(e).fieldValue,"onUpdate:modelValue":t[2]||(t[2]=a=>l(e).fieldValue=a),class:"search-field-value",size:"mini",placeholder:"\u9009\u62E9\u65E5\u671F\u65F6\u95F4",type:"datetimerange","range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",onChange:c},null,8,["modelValue"])):g("",!0)]),n("div",ge,[r(w,{size:"mini",onClick:D},{default:d(()=>[me]),_:1}),r(w,{size:"mini",type:"primary",onClick:c},{default:d(()=>[fe]),_:1})])])])]),r(q,null,{default:d(()=>[n("div",be,[n("div",he,[n("div",ve,[l(e).tableCol&&l(e).tableCol.length?(i(),u(A,{key:0,"table-title":[],"table-data":l(e).tableData,"need-pagination":!0},{default:d(()=>[(i(!0),f(I,null,S(l(e).tableCol,a=>(i(),u(v,{key:a.name,label:a.name,prop:a.field,"show-overflow-tooltip":"","min-width":"80px"},{header:d(()=>[n("div",ye,[a.type?(i(),f("div",Te,[a.type&&["THIRD","BUSINESS"].includes(a.type)?(i(),f("img",{key:0,src:V(a.type)},null,8,we)):g("",!0)])):g("",!0),n("div",null,p(a.name),1)])]),default:d(k=>[n("span",{class:oe([a.is_subject?"clickable":""]),onClick:Ve=>C(a,k.row)},p(k.row[a.field]||"\u2014"),11,ke)]),_:2},1032,["label","prop"]))),128))]),_:1},8,["table-data"])):g("",!0)]),n("div",xe,[l(e).tableData.length?(i(),u(Y,{key:0,"current-page":l(e).pageNo,"page-sizes":l(e).pageSizes,"page-size":l(e).pageSize,layout:"total, sizes, prev, pager, next, jumper",total:l(e).totalNo,onSizeChange:N,onCurrentChange:E},null,8,["current-page","page-sizes","page-size","total"])):g("",!0)])]),r(R,{modelValue:l(e).dialogVisible,"onUpdate:modelValue":t[3]||(t[3]=a=>l(e).dialogVisible=a),title:"\u5173\u8054\u4E3B\u4F53\u8BE6\u60C5",width:"418px","custom-class":"event-snap-dialog"},{default:d(()=>[n("span",null,"\u5FEB\u7167\u65F6\u95F4\uFF1A"+p(l(e).dialogTime),1),r(B,{data:l(e).dialogTableData,style:{"max-width":"100%","margin-top":"12px"},size:"mini",height:"270","show-header":!0,border:""},{default:d(()=>[r(v,{label:"\u5B57\u6BB5\u540D\u79F0",prop:"name","show-overflow-tooltip":"","min-width":"80px","class-name":"table-column-name"},{default:d(a=>[n("span",Ie,p(a.row.name),1)]),_:1}),r(v,{label:"\u503C",prop:"content","show-overflow-tooltip":"","min-width":"80px"},{default:d(a=>[y(p(a.row.content),1)]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"])])]),_:1})])}}};var Ee=ne(Se,[["__scopeId","data-v-09cae71d"]]);export{Ee as default};
