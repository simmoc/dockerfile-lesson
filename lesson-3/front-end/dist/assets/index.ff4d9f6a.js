
/**
 * 由 Fantastic-admin 提供技术支持
 * https://hooray.gitee.io/fantastic-admin/
 * Powered by Fantastic-admin
 * https://hooray.github.io/fantastic-admin/
 */
    
var Z=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var j=(c,e,d)=>e in c?Z(c,e,{enumerable:!0,configurable:!0,writable:!0,value:d}):c[e]=d,A=(c,e)=>{for(var d in e||(e={}))le.call(e,d)&&j(c,d,e[d]);if(M)for(var d of M(e))ae.call(e,d)&&j(c,d,e[d]);return c},I=(c,e)=>ee(c,te(e));import{_ as oe}from"./select-member.d05cd3eb.js";import{_ as ne}from"./index.fece4a24.js";import{_ as se}from"./index.333b158c.js";import{_ as re}from"./index.f1e12eef.js";import{Q as ie,M as de,o as ce,r as m,a as g,q as S,t as i,y as o,L as r,z as n,B as _e,C as D,J as me,v as ue,x as pe,A as w,c as N,D as fe,H as p,F as he,G as ge,E as k}from"./vendor.d2559d84.js";import{H as $}from"./index.94e839d6.js";import{N as be}from"./index.4c9825d9.js";import{_ as ve}from"./plugin-vue_export-helper.21dcd24c.js";import"./tick@2x.1e6bc440.js";import"./vuedraggable.umd.56963d08.js";import"./sortable.esm.81321d43.js";import"./contant.2e72a177.js";import"./error.32433a76.js";const x=c=>(he("data-v-4e473f8a"),c=c(),ge(),c),we={class:"search-form"},xe={class:"flex flex-justify-between"},ye={class:"flex-1 search-form-margin"},Se=p(" \u524D30% "),ke=p(" \u540E30% "),Ce=p("\u91CD\u7F6E"),Ve=p(" \u67E5\u8BE2 "),ze={key:0},Me={class:"flex-1 flex-direction-column"},je={class:"table-head flex flex-justify-between"},Ae={class:"table-head-left overflow-ellipsis"},Ie=x(()=>i("span",null,"\u6279\u91CF\u5220\u9664",-1)),De=x(()=>i("div",{class:"table-head-right"},null,-1)),Ne=x(()=>i("div",null,"\u6279\u91CF",-1)),$e={class:"flex flex-align-center color-primary pointer"},Ke={key:0},Be={class:"popover-content-box"},Ee={class:"popover-content"},Ue=p(" \u5220\u9664 "),Te={class:"table-pagination-wrap flex flex-justify-end"},qe=x(()=>i("div",null,[i("span",{class:"new-group-title"},"\u63D0\u793A")],-1)),Fe={class:"dialog-body"},He={class:"group_name"},Le={class:"dialog-footer"},Oe=p("\u53D6 \u6D88"),Re=p("\u786E \u5B9A"),Ge={key:1},Je=x(()=>i("div",null,"\u6682\u65E0\u6210\u5458\u8BDD\u672F!",-1)),Qe={setup(c){const e=ie({writeBackSelectedMemberOrg:[],search:{search_send_num_type:"",search_content:""},dialogIsKnowdege:!1,pageNo:1,pageSizes:[10,15,20],tableData:[],pageSize:10,totalNo:0,param:{},currentSelectAll:[],customInputValueFn:a=>B(a,3)||"",deleteMsg:"",deleteMemberId:""}),d=de(null);ce(()=>{u()});function C(a){a===e.search.search_send_num_type?e.search.search_send_num_type="":e.search.search_send_num_type=a,u(),e.currentSelectAll=[]}function K(a,t){if(a){let s=!1;e.currentSelectAll.forEach(_=>{_.sale_script_id===t.sale_script_id&&(s=!0)}),!s&&e.currentSelectAll.push(t)}else{let s="";e.currentSelectAll.forEach((_,f)=>{_.sale_script_id===t.sale_script_id&&(s=f)}),e.currentSelectAll.splice(s,1)}}function B(a,t){return`${a.slice(0,t).map(s=>s.member_name||s.department_name).join("\uFF0C")}${a.length>t?"...":""}`}function y(){u()}function E(){e.search={search_send_num_type:"",search_content:"",search_department_id_arr:[],search_member_id_arr:[]},console.log("111111",d),d.value.resetSelect(),u()}function U(a,t){const s=200;return t>=s?(k({message:`\u6700\u591A\u652F\u6301\u5BA2\u6237\u4EBA\u6570${s}\u4EBA`,type:"error"}),!1):!0}function T(a){e.writeBackSelectedMemberOrg=a;let t=[],s=[];a&&Array.isArray(a)&&(a.map(_=>{_.isOrg?s.push(_.id):t.push(_.id)}),e.search.search_department_id_arr=s,e.search.search_member_id_arr=t,y()),d.value&&(d.value.dialogVisible=!1)}function q(a){$.deleteSaleScript({sale_script_id_arr:a}).then(t=>{(t.code===200||t.code===0)&&(e.currentSelectAll=[],k.success("\u5220\u9664\u6210\u529F\uFF01"),e.dialogIsKnowdege=!1,u())}).catch(()=>{})}async function u(){let a=I(A({},e.search),{page_num:e.pageNo,page_size:e.pageSize});$.getSaleScriptList(a).then(t=>{e.tableData=t.data&&t.data.list,e.totalNo=t.data&&t.data.total_num,e.tableData.map(s=>{s.checked=!1}),setTimeout(()=>{e.currentSelectAll.length>0&&e.tableData.forEach(s=>{e.currentSelectAll.forEach(_=>{s.sale_script_id===_.sale_script_id&&(s.checked=!0)})})},200)}).catch(()=>{})}function F(a){e.pageSize=a,e.pageNo=1,u()}function V(a,t,s){e.deleteMsg=a,e.dialogIsKnowdege=!0,e.deleteMemberId=s}async function H(a){e.pageNo=a,await u()}function L(a,t){if(e.currentSelectAll.length==0){k.error("\u8BF7\u9009\u62E9\u5220\u9664\u7684\u6210\u5458");return}V(a,t,e.currentSelectAll)}return(a,t)=>{const s=m("el-input"),_=oe,f=m("el-form-item"),z=m("el-radio-button"),O=m("el-radio-group"),b=m("el-button"),R=m("el-form"),G=m("el-checkbox"),v=m("el-table-column"),J=ne,Q=m("el-popover"),P=se,W=m("el-pagination"),X=m("el-dialog"),Y=re;return g(),S("div",null,[i("div",we,[i("div",xe,[i("div",ye,[o(R,{"label-position":"right",inline:!0,model:r(e).search,size:"small","label-width":"120px"},{default:n(()=>[o(f,{label:"\u4F01\u5FAE\u6210\u5458\uFF1A"},{default:n(()=>[o(_,{ref_key:"addMemberDialogRef",ref:d,"input-placeholder":"\u8BF7\u9009\u62E9\u4F01\u5FAE\u6210\u5458","is-multiple-selected":!0,"custom-input-value-fn":r(e).customInputValueFn,"custom-selected-fn":U,style:{width:"200px"},onConfirm:T},{default:n(l=>[i("span",null,[o(s,{modelValue:l.data,"onUpdate:modelValue":h=>l.data=h,placeholder:"\u8BF7\u9009\u62E9","suffix-icon":"el-icon-caret-bottom",readonly:""},null,8,["modelValue","onUpdate:modelValue"])])]),_:1},8,["custom-input-value-fn"])]),_:1}),o(f,{label:"\u6587\u672C\u5185\u5BB9 \uFF1A"},{default:n(()=>[o(s,{modelValue:r(e).search.search_content,"onUpdate:modelValue":t[0]||(t[0]=l=>r(e).search.search_content=l),modelModifiers:{trim:!0},style:{width:"210px"},size:"small",placeholder:"\u8BF7\u8F93\u5165\u6587\u672C\u5185\u5BB9","show-word-limit":"",clearable:"",onClear:y,onKeyup:_e(y,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),o(f,{label:"\u53D1\u9001\u6B21\u6570\u6392\u540D \uFF1A",class:"separate-radio"},{default:n(()=>[o(O,{modelValue:r(e).search.search_send_num_type,"onUpdate:modelValue":t[3]||(t[3]=l=>r(e).search.search_send_num_type=l)},{default:n(()=>[o(z,{label:1,onClick:t[1]||(t[1]=D(l=>C(1),["prevent"]))},{default:n(()=>[Se]),_:1}),o(z,{label:2,style:{"margin-left":"-3px"},onClick:t[2]||(t[2]=D(l=>C(2),["prevent"]))},{default:n(()=>[ke]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(f,null,{default:n(()=>[o(b,{size:"small",onClick:E},{default:n(()=>[Ce]),_:1}),o(b,{type:"primary",size:"small",onClick:y},{default:n(()=>[Ve]),_:1})]),_:1})]),_:1},8,["model"])])])]),o(Y,{class:"flex flex-direction-column search-table-page event-list-page"},{default:n(()=>[r(e).tableData.length>0?(g(),S("div",ze,[i("div",Me,[i("div",je,[i("div",Ae,[i("div",{class:me(["delete-btn",{"delete-width":r(e).currentSelectAll.length>0}]),onClick:t[4]||(t[4]=l=>L("\u662F\u5426\u5220\u9664\u5DF2\u9009\u62E9\u8BDD\u672F","deleteMember"))},[Ie,ue(i("div",{class:"delete-num"},w(r(e).currentSelectAll&&r(e).currentSelectAll.length),513),[[pe,r(e).currentSelectAll.length>0]])],2)]),De]),o(P,{ref:"multipleTable","table-data":r(e).tableData,style:{width:"100%",position:"relative"},size:"small"},{default:n(()=>[o(v,{width:"55"},{header:n(()=>[Ne]),default:n(l=>[o(G,{modelValue:l.row.checked,"onUpdate:modelValue":h=>l.row.checked=h,onChange:h=>K(h,l.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),o(v,{label:"\u4F01\u5FAE\u6210\u5458","show-overflow-tooltip":"","min-width":"80px"},{default:n(l=>[i("div",$e,[o(J,{class:"table-member-card","member-id":l.row.member_id,avatar:l.row.qw_avatar,name:l.row.qw_name,"department-name":l.row.qw_department_name},null,8,["member-id","avatar","name","department-name"])])]),_:1}),o(v,{label:"\u5185\u5BB9",prop:"content","min-width":"150px"},{default:n(({row:l})=>[l.content.length<=34?(g(),S("div",Ke,w(l.content),1)):(g(),N(Q,{key:1,placement:"bottom",width:"400",trigger:"hover","popper-class":"member-info-pop"},{reference:n(()=>[i("div",Ee,w(l.content.substring(0,34))+" ... ",1)]),default:n(()=>[i("div",Be,w(l.content),1)]),_:2},1024))]),_:1}),o(v,{label:"\u53D1\u9001\u6B21\u6570",prop:"send_num","show-overflow-tooltip":""}),o(v,{label:"\u64CD\u4F5C",width:"160px",fixed:"right"},{default:n(l=>[o(b,{type:"text",size:"mini",onClick:h=>V("\u662F\u5426\u5220\u9664\u8BE5\u8BDD\u672F","deleteMember",[l.row.sale_script_id])},{default:n(()=>[Ue]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["table-data"]),i("div",Te,[r(e).tableData&&r(e).tableData.length?(g(),N(W,{key:0,"current-page":r(e).pageNo,"page-sizes":r(e).pageSizes,"page-size":r(e).pageSize,layout:"total, sizes, prev, pager, next, jumper",total:r(e).totalNo,onSizeChange:F,onCurrentChange:H},null,8,["current-page","page-sizes","page-size","total"])):fe("",!0)])]),o(X,{modelValue:r(e).dialogIsKnowdege,"onUpdate:modelValue":t[7]||(t[7]=l=>r(e).dialogIsKnowdege=l),width:"30%"},{title:n(()=>[qe]),footer:n(()=>[i("span",Le,[o(b,{onClick:t[5]||(t[5]=l=>r(e).dialogIsKnowdege=!1)},{default:n(()=>[Oe]),_:1}),o(b,{type:"primary",onClick:t[6]||(t[6]=l=>q(r(e).deleteMemberId))},{default:n(()=>[Re]),_:1})])]),default:n(()=>[i("div",Fe,[i("div",He,w(r(e).deleteMsg),1)])]),_:1},8,["modelValue"])])):(g(),S("div",Ge,[o(be,null,{content:n(()=>[Je]),_:1})]))]),_:1})])}}};var dt=ve(Qe,[["__scopeId","data-v-4e473f8a"]]);export{dt as default};
