
/**
 * 由 Fantastic-admin 提供技术支持
 * https://hooray.gitee.io/fantastic-admin/
 * Powered by Fantastic-admin
 * https://hooray.github.io/fantastic-admin/
 */
    
import{H as u}from"./index.94e839d6.js";import{_ as D}from"./plugin-vue_export-helper.21dcd24c.js";import{E as y,r as f,a as i,q as h,t as g,y as b,z as C,c as N,D as k,R as x,S as v,A as L}from"./vendor.d2559d84.js";const M={name:"",emits:["changeCustomerInfo"],data(){return{model:"default",memberList:[],keyword:"",treeData:[],chatInfo:{},treeExpandData:[1],defaultProps:{children:"children",label:"department_name"}}},created(){console.log(999),this.getGroupList()},methods:{handleNodeClick(e,t){let{parentid:n,id:o,label:a}=e,r=e&&e.department_id||"";if(r){if(console.log("node-click",e,n),o)return this.$emit("changeCustomerInfo",{staffInfo:e,chatInfo:{}}),console.log("\u70B9\u51FB\u4E86\u6210\u5458\u4FE1\u606F",e),!1;console.log(t),(t.expanded||t.childNodes.length===0)&&(this.getMember(r,a),t.expanded=!0)}},getGroupList(){u.getChildDepartment().then(e=>{let t=e.data;this.addLabel(t),this.treeData=e.data,this.treeData.length>0&&this.treeExpandData.push(this.treeData[0].department_id),console.log("getGroupList---getGroupList",t)}).catch(e=>{y.error(e)})},addLabel(e,t=[]){e.forEach((n,o)=>{let a=JSON.parse(JSON.stringify(t));a.push(o),n.label=JSON.parse(JSON.stringify(a));let r=n.children||[];r.length>0&&this.addLabel(r,JSON.parse(JSON.stringify(a))),(!r||r.length===0)&&(n.children=r)})},getMember(e,t=[]){let n={id:e,pageSize:100};u.getMember(n).then(o=>{let a=o.data.list;a.forEach(l=>{l.department_id=l.id,l.department_name=l.qw_name}),this.selectData=this.treeData;let r=t.length;t.forEach((l,p)=>{if(p<r-1){let s=this.selectData[l].children;console.log("children",s),this.selectData=s}else{let s=this.selectData[l].children.concat(a);var c={};s=s.reduce(function(m,_){return c[_.department_id]||(c[_.department_id]=m.push(_)),m},[]),this.selectData[l].children=s}}),console.log("getMember---getMember",o.data.list)})},selectMember(e){this.$parent.staffInfo=Object.assign(e,{department_id:e.id,department_name:e.qw_name}),this.$parent.chatInfo={}},searchMember(){let e={keyword:this.keyword};u.getMember(e).then(t=>{this.model="search",this.memberList=t.data.list,console.log("\u5F53\u524D\u7684\u641C\u7D22\u6A21\u5F0Flist",t.data.list)})},clearMember(){this.model="default",this.getGroupList(),console.log("\u6E05\u7A7A\u4E86input\u6570\u636E")}}},E={class:"organize"},w={class:"filter"},I={class:"tree-data"},S={key:1,class:"member-box"},O=["onClick"];function J(e,t,n,o,a,r){const l=f("el-button"),p=f("el-input"),c=f("el-tree");return i(),h("div",E,[g("div",w,[b(p,{modelValue:a.keyword,"onUpdate:modelValue":t[0]||(t[0]=d=>a.keyword=d),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",clearable:"",onClear:r.clearMember},{append:C(()=>[b(l,{icon:"el-icon-search",onClick:r.searchMember},null,8,["onClick"])]),_:1},8,["modelValue","onClear"])]),g("div",I,[a.model=="default"?(i(),N(c,{key:0,ref:"tree",data:a.treeData,"node-key":"department_id","default-expanded-keys":a.treeExpandData,props:a.defaultProps,onNodeClick:r.handleNodeClick,onNodeExpand:r.handleNodeClick},null,8,["data","default-expanded-keys","props","onNodeClick","onNodeExpand"])):k("",!0),a.model=="search"?(i(),h("div",S,[(i(!0),h(x,null,v(a.memberList,(d,s)=>(i(),h("div",{key:s,class:"member-item",onClick:m=>r.selectMember(d)},[g("span",null,L(d.qw_name),1)],8,O))),128))])):k("",!0)])])}var j=D(M,[["render",J],["__scopeId","data-v-da7b53b4"]]);export{j as default};
