
/**
 * 由 Fantastic-admin 提供技术支持
 * https://hooray.gitee.io/fantastic-admin/
 * Powered by Fantastic-admin
 * https://hooray.github.io/fantastic-admin/
 */
    
import{_ as $}from"./index.f1e12eef.js";import{H as g,b as ee}from"./index.94e839d6.js";import{C as te}from"./index.384ab11c.js";import{P as ae,O as oe,Q as M,M as d,o as le,r as h,a5 as se,a as _,q as w,t as s,A as m,L as u,y as i,z as r,R as F,S as U,c as V,D as H,v as re,F as ne,G as de,H as q,E as j}from"./vendor.d2559d84.js";import{_ as ie}from"./plugin-vue_export-helper.21dcd24c.js";import"./index.41459e6c.js";import"./word-img.bb3865fc.js";import"./drag.56588ea6.js";import"./sortable.esm.81321d43.js";import"./index.5931791c.js";import"./index.a3c908a5.js";import"./formValidate.137fd30a.js";const ue=y=>(ne("data-v-13a5c673"),y=y(),de(),y),ce={class:"head-content"},_e={class:"head-content-item"},pe={class:"head-content-item"},me={class:"head-content-item"},fe={class:"head-content-item"},ve={class:"search-head-wrap flex-row-between bg-color-fff p-24"},ge={class:"flex flex-justify-between flex-align-center"},he={key:0,class:"el-icon-check",style:{color:"#1773fa","font-size":"13px"}},we=["title"],ye={key:0,class:"active-word-absolute"},be={class:"el-form-item__label"},xe=ue(()=>s("i",{class:"color-red"},"*",-1)),ke=q(" \u77E5\u8BC6\u5185\u5BB9 "),Ie={class:"el-form-item_label-span"},Ke=q("\u53D6 \u6D88"),Ve=q("\u63D0 \u4EA4"),qe={setup(y){const L=ae(),v=oe(),b=M({search_name:"",page_num:1,page_size:5}),l=d({group_id:"",keyword_arr:[],content_arr:[]}),c=d([]),N=d(0),C=d([]),f=d([]),x=d([]),S=d({}),D=d(""),O=d(""),E=d(null),k=d(!1),n=M({member_name:"",update_time:"",create_time:""});le(()=>{let e=v.query;e.group_id&&e.sale_scrip_id&&(l.value.sale_script_id=Number(e.sale_scrip_id),n.member_name=e.member_name,n.update_time=e.update_time,n.create_time=e.create_time,A()),e.group_id&&(l.value.group_id=Number(e.group_id));var t=document.querySelector(".keys-overflow-scoll .el-input--suffix .el-input__suffix-inner>i");t.classList.add("el-icon-arrow-up")});const R=()=>{L.go(-1)},A=async()=>{let e=v.query;l.value.group_id=Number(e.group_id);let{data:t}=await g.getKnowledgeDetails({sale_script_id:e.sale_scrip_id});t.keyword_arr.forEach(o=>{x.value.push(o.name)}),t.content_arr.forEach(o=>{if(o.type==="LINK"){let p=o.qw_link_url.split("//");o.qw_link_url=p[1],o.url=p[0]+"//"}}),f.value=t.content_arr},J=async()=>{if(!l.value.group_id){j.error({message:"\u6DFB\u52A0\u5931\u8D25,\u8BF7\u9009\u62E9\u5206\u7EC4\u540E\u518D\u8FDB\u884C\u6DFB\u52A0!",type:"error",showClose:!0});return}if(!f.value.length){j.error({message:"\u77E5\u8BC6\u5E93\u7D20\u6750\u4E0D\u80FD\u4E3A\u7A7A!",type:"error",showClose:!0});return}let e=JSON.parse(JSON.stringify(f.value));e.forEach(o=>{o.type==="LINK"&&(o.qw_link_url=o.url+o.qw_link_url)}),l.value.content_arr=e,x.value.forEach(o=>{l.value.keyword_arr.push({name:o})});let t="";v.query.group_id&&v.query.sale_scrip_id?t=await g.updateKnowledge(l.value):t=await g.addKnowledgeSpeech(l.value),t.code===200&&(j.success({message:"\u63D0\u4EA4\u6210\u529F"}),L.replace({name:"knowledgeBaseList",query:{group_id:v.query.group_id}}))},G=e=>{S.value.search_group_name=e,z()},T=ee(e=>{e.length>5&&(E.value.query=e.substring(0,5)),e?I(e):(k.value=!1,b.page_num=1,c.value=[],I())}),P=()=>{k.value=!1},Q=()=>{D.value=l.value.group_id,G("")},z=async()=>{let{data:e}=await g.getGroupList(S.value);C.value=e},W=()=>{b.page_num=++b.page_num,N.value>c.value.length&&I()},I=async e=>{let{data:t}=await g.getKeywordList({search_name:e,page_num:b.page_num});e?(c.value=[],c.value=t.list,c.value.findIndex(p=>p.name===e)===-1&&(k.value=!0)):c.value=[...c.value,...t.list],N.value=t.total_num};return I(),z(),(e,t)=>{const o=h("el-option"),p=h("el-select"),K=h("el-form-item"),B=h("el-button"),X=h("el-form"),Y=$,Z=se("el-select-loadmore");return _(),w("div",null,[s("div",ce,[s("div",_e," \u521B\u5EFA\u6210\u5458\uFF1A"+m(u(n)&&u(n).member_name||"\u2014"),1),s("div",pe," \u521B\u5EFA\u65F6\u95F4\uFF1A"+m(u(n)&&u(n).create_time||"\u2014"),1),s("div",me," \u6700\u540E\u4FEE\u6539\u6210\u5458\uFF1A"+m(u(n)&&u(n).member_name||"\u2014"),1),s("div",fe," \u6700\u540E\u4FEE\u6539\u65F6\u95F4\uFF1A"+m(u(n)&&u(n).update_time||"\u2014"),1)]),i(Y,{class:""},{default:r(()=>[s("div",ve,[i(X,{ref:"ruleForm",modelValue:l.value,"onUpdate:modelValue":t[3]||(t[3]=a=>l.value=a),class:"demo-ruleForm",height:"32px","label-width":"520px","label-position":"top"},{default:r(()=>[i(K,{required:"",label:"\u77E5\u8BC6\u5206\u7EC4"},{default:r(()=>[i(p,{modelValue:l.value.group_id,"onUpdate:modelValue":t[0]||(t[0]=a=>l.value.group_id=a),style:{width:"520px"},"el-select":"",filterable:"","filter-method":G,"default-first-option":"",placeholder:O.value,class:"form-ipt-style","no-match-text":"no data","no-data-text":"no data",onChange:Q},{default:r(()=>[(_(!0),w(F,null,U(C.value,a=>(_(),V(o,{key:a.group_id,label:a.name,value:a.group_id,disabled:a.sale_script_num>=20},{default:r(()=>[s("div",ge,[s("span",null,m(a.name),1),D.value==a.group_id?(_(),w("i",he)):H("",!0)])]),_:2},1032,["label","value","disabled"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1}),i(K,{label:"\u5173\u952E\u8BCD"},{default:r(()=>[re((_(),V(p,{ref_key:"selectIpt",ref:E,modelValue:x.value,"onUpdate:modelValue":t[1]||(t[1]=a=>x.value=a),class:"ipt-type keys-overflow-scoll","el-select":"",multiple:"",placeholder:"\u8F93\u5165\u5173\u952E\u8BCD",filterable:"",remote:"","no-match-text":"no data","no-data-text":"no data","remote-method":u(T),size:"small","reserve-keyword":"","default-first-option":"",clearable:"","popper-append-to-body":!1,style:{width:"520px"},"allow-create":"",onChange:P},{default:r(()=>[(_(!0),w(F,null,U(c.value,a=>(_(),V(o,{key:a.keyword_id,label:a.name,value:a.name},{default:r(()=>[s("span",{style:{float:"left",width:"250px",overflow:"hidden","text-overflow":"ellipsis"},title:a.name},m(a.name),9,we)]),_:2},1032,["label","value"]))),128)),k.value?(_(),w("div",ye," \u56DE\u8F66\u4F7F\u7528 ")):H("",!0)]),_:1},8,["modelValue","remote-method"])),[[Z,W]])]),_:1}),i(K,{required:""},{default:r(()=>[s("label",be,[xe,ke,s("span",Ie," \u53EF\u6DFB\u52A0\u7D20\u6750\u6570\u91CF "+m(f.value.length)+"/10 ",1)]),i(te,{modelValue:f.value,"onUpdate:modelValue":t[2]||(t[2]=a=>f.value=a),"text-limit":800},null,8,["modelValue"])]),_:1}),i(K,{class:"item-button tr"},{default:r(()=>[i(B,{size:"small",onClick:R},{default:r(()=>[Ke]),_:1}),i(B,{type:"primary",size:"small",onClick:J},{default:r(()=>[Ve]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})])}}};var Ue=ie(qe,[["__scopeId","data-v-13a5c673"]]);export{Ue as default};
