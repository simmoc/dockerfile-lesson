
/**
 * 由 Fantastic-admin 提供技术支持
 * https://hooray.gitee.io/fantastic-admin/
 * Powered by Fantastic-admin
 * https://hooray.github.io/fantastic-admin/
 */
    
import{Q as N,ae as O,I as D,o as z,r as f,a as r,q as d,L as s,R as h,S as v,t as m,A as V,c as i,D as u,z as L,y as b,C as y,J as B,F as H,G as Y}from"./vendor.d2559d84.js";import{H as R}from"./index.94e839d6.js";import{e as J}from"./error.32433a76.js";import{_ as P}from"./plugin-vue_export-helper.21dcd24c.js";const $=p=>(H("data-v-58041b48"),p=p(),Y(),p),q=["label"],G={class:"label pl12 pr12"},K=["src","onClick"],Q=["onClick"],X=$(()=>m("svg",{class:"icon",width:"12",height:"12",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","data-v-042ca774":""},[m("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0164 0v352h352a32 32 0 110 64H544v352a32 32 0 11-64 0V544H128a32 32 0 010-64h352z"})],-1)),W=["onClick"],Z={class:"ul"},ee=["onClick"],te={key:1,class:"li no-data"},ae={props:{modelValue:{type:Object},subjectId:{type:[Number,String],default:""},closeCustomerSelect:{type:Function}},emits:["update:modelValue"],setup(p,{expose:g,emit:C}){const _=p,e=N({search:"",formData:{},visible:!1,filterList:[],customList:[],where_dynamic:[],curList:[]});O(()=>{C("update:modelValue",e.where_dynamic)}),e.curList=D(()=>{let t=[];return e.filterList.length&&(t=e.filterList.filter(l=>l.label.includes(e.search))),t}),e.where_dynamic=D(()=>{let t=[];for(const l in e.formData)if(Object.hasOwnProperty.call(e.formData,l)){const n=e.customList.find(c=>c.name==l);n&&w(e.formData[l])&&t.push({type:n.type,field:l,value:n.type==="DATETIME"||n.type==="SELECT"?e.formData[l].join(","):e.formData[l]})}return t});const w=t=>Array.isArray(t)?t.length:!(!t&&t!==0),x=t=>{const l=24*60*60*1e3,n=Date.now(),c=n-l*90;return t.getTime()>n||t.getTime()<c};function E(t,l){e.formData[l.name]=t!=null?t:[]}const T=t=>{e.customList.findIndex(n=>n.name===t.name)===-1&&(e.customList.push(t),t.active=!0,e.visible=!1)},U=t=>{const l=e.customList.findIndex(n=>n.name===t.name);l!==-1&&(e.customList.splice(l,1),delete e.formData[t.name],t.active=!1)},S=()=>{R.extensiveCustomerSearchFieldList({subject_id:_.subjectId}).then(t=>{t.data&&Array.isArray(t.data)&&(e.filterList=t.data.filter(F))})},F=t=>!["\u4E1A\u52A1ID","\u6DFB\u52A0\u65F6\u95F4","\u6807\u7B7E"].includes(t.label)&&t.type!=="SUBJECT",j=()=>{for(const t in e.formData)Object.hasOwnProperty.call(e.formData,t)&&(e.formData[t]="")},I=()=>{typeof _.closeCustomerSelect=="function"&&_.closeCustomerSelect(),e.visible=!e.visible,e.search=""},A=()=>{e.visible=!0};return g({resetFields:j}),z(async()=>{S(),document.body.addEventListener("click",()=>{e.visible=!1,e.search=""},!1)}),(t,l)=>{const n=f("el-input"),c=f("el-option"),k=f("el-select"),M=f("el-date-picker");return r(),d(h,null,[s(e).customList.length?(r(!0),d(h,{key:0},v(s(e).customList,a=>(r(),d("div",{ref_for:!0,ref:"customForm",key:a.name,label:a.label+"\uFF1A",class:"custom-list mr36 mb16"},[m("span",G,V(a.label),1),a.type==="TEXT"?(r(),i(n,{key:0,modelValue:s(e).formData[a.name],"onUpdate:modelValue":o=>s(e).formData[a.name]=o,modelModifiers:{trim:!0},placeholder:"\u8BF7\u8F93\u5165",style:{width:"274px"},size:"small"},null,8,["modelValue","onUpdate:modelValue"])):u("",!0),a.type==="NUMBER"?(r(),i(n,{key:1,modelValue:s(e).formData[a.name],"onUpdate:modelValue":o=>s(e).formData[a.name]=o,modelModifiers:{trim:!0},type:"number",placeholder:"\u8BF7\u8F93\u5165",style:{width:"274px"},size:"small"},null,8,["modelValue","onUpdate:modelValue"])):u("",!0),a.type==="SELECT"?(r(),i(k,{key:2,modelValue:s(e).formData[a.name],"onUpdate:modelValue":o=>s(e).formData[a.name]=o,class:"m-2",placeholder:"\u8BF7\u9009\u62E9",multiple:"","collapse-tags":"",style:{width:"274px"},size:"small"},{default:L(()=>[(r(!0),d(h,null,v(a.options,o=>(r(),i(c,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):u("",!0),a.type==="BOOLEAN"?(r(),i(k,{key:3,modelValue:s(e).formData[a.name],"onUpdate:modelValue":o=>s(e).formData[a.name]=o,class:"m-2",placeholder:"\u8BF7\u9009\u62E9",style:{width:"274px"},size:"small"},{default:L(()=>[(r(),i(c,{key:1,label:"\u662F",value:"\u662F"})),(r(),i(c,{key:0,label:"\u5426",value:"\u5426"})),b(c,{key:"NOT",label:"\u975E\u7A7A",value:"NOT"}),b(c,{key:"NULL",label:"\u7A7A\u503C",value:"NULL"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):u("",!0),a.type==="DATETIME"?(r(),i(M,{key:4,modelValue:s(e).formData[a.name],"onUpdate:modelValue":o=>s(e).formData[a.name]=o,type:"datetimerange","range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65F6\u95F4","end-placeholder":"\u7ED3\u675F\u65F6\u95F4","value-format":"YYYY/MM/DD HH:mm:ss","disabled-date":x,style:{width:"274px"},size:"small",onChange:o=>E(o,a)},null,8,["modelValue","onUpdate:modelValue","onChange"])):u("",!0),m("img",{class:"icon",width:"16",height:"16",src:s(J),onClick:y(o=>U(a),["stop"])},null,8,K)],8,q))),128)):u("",!0),m("div",{class:"add-btn mr8 ml8",onClick:y(I,["stop"])},[X,s(e).visible?(r(),d("div",{key:0,class:"show-select",onClick:y(A,["stop"])},[b(n,{modelValue:s(e).search,"onUpdate:modelValue":l[0]||(l[0]=a=>s(e).search=a),placeholder:"\u641C\u7D22\u81EA\u5B9A\u4E49\u5B57\u6BB5\u540D\u79F0",class:"mb8 input"},null,8,["modelValue"]),m("div",Z,[s(e).curList.length?(r(!0),d(h,{key:0},v(s(e).curList,a=>(r(),d("div",{key:a.name,class:B(["li",[a.active?"disabled":"","tl pl20 pr20"]]),onClick:y(o=>T(a),["stop"])},V(a.label),11,ee))),128)):(r(),d("div",te,"\u6682\u65E0\u6570\u636E"))])],8,W)):u("",!0)],8,Q)],64)}}};var ne=P(ae,[["__scopeId","data-v-58041b48"]]);export{ne as default};
