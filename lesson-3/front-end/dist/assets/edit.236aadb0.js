
/**
 * 由 Fantastic-admin 提供技术支持
 * https://hooray.gitee.io/fantastic-admin/
 * Powered by Fantastic-admin
 * https://hooray.github.io/fantastic-admin/
 */
    
import{_ as X}from"./index.f1e12eef.js";import{H as y}from"./index.94e839d6.js";import{C as Y}from"./index.41459e6c.js";import{P as Z,O as $,Q as ee,M as o,o as te,r as v,a5 as ae,a as c,q as f,t as n,A as m,y as u,z as s,R as M,S as B,c as q,D as S,v as le,H as V,E as w}from"./vendor.d2559d84.js";import{_ as oe}from"./plugin-vue_export-helper.21dcd24c.js";import"./word-img.bb3865fc.js";import"./drag.56588ea6.js";import"./sortable.esm.81321d43.js";const se={class:"head-content"},re={class:"head-content-item"},ne={class:"head-content-item"},ue={class:"head-content-item"},ie={class:"head-content-item"},de={class:"search-head-wrap flex-row-between bg-color-fff p-24"},ce={class:"flex flex-justify-between flex-align-center"},_e={key:0,class:"el-icon-check",style:{color:"#1773fa","font-size":"13px"}},pe=["title"],me={key:0,class:"active-word-absolute"},ve={class:"el-form-item__label"},fe=V(" \u77E5\u8BC6\u5185\u5BB9 "),ge=V("\u53D6 \u6D88"),he=V("\u63D0 \u4EA4"),ye={setup(we){const b=Z(),i=$(),x=ee({search_name:"",page_num:1,page_size:5}),r=o({group_id:"",keyword_arr:[],content_arr:[]}),l=o({create_time:"",member_name:"",update_time:"",sale_scrip_id:""}),_=o([]),C=o(0),D=o([]),g=o([]),d=o([]),K=o({}),j=o(""),F=o(""),H=o(null),k=o(!1);te(()=>{if(i.query.group_id&&i.query.sale_scrip_id&&I(),i.query.group_id&&(r.value.group_id=Number(i.query.group_id)),i.query.eventDetail){let e=JSON.parse(i.query.eventDetail);l.value.create_time=e.create_time,l.value.member_name=e.member_name,l.value.update_time=e.update_time,l.value.sale_scrip_id=e.sale_scrip_id,r.value.sale_script_id=e.sale_scrip_id,I()}});const O=()=>{b.go(-1)},I=async()=>{let{data:e}=await y.getKnowledgeDetails({sale_script_id:l.value.sale_scrip_id});e.keyword_arr.forEach(t=>{d.value.push(t.name)}),g.value=e.content_arr},R=async()=>{if(!r.value.group_id){w.error({message:"\u6DFB\u52A0\u5931\u8D25,\u8BF7\u9009\u62E9\u5206\u7EC4\u540E\u518D\u8FDB\u884C\u6DFB\u52A0!",type:"error",showClose:!0});return}if(!g.value.length){w.error({message:"\u77E5\u8BC6\u5E93\u7D20\u6750\u4E0D\u80FD\u4E3A\u7A7A!",type:"error",showClose:!0});return}r.value.content_arr=g.value,d.value.forEach(p=>{r.value.keyword_arr.push({name:p})});let e=JSON.parse(i.query.eventDetail);console.error("route.query",e);let t="";i.query.group_id&&e.sale_scrip_id&&(t=await y.updateKnowledge(r.value),console.error("111111",t)),t.code===200&&(w.success({message:"\u63D0\u4EA4\u6210\u529F"}),b.replace({name:"marketing-reply",query:{group_id:i.query.group_id}})),b.go(-1)},L=e=>{K.value.search_group_name=e,N()},U=()=>{j.value=r.value.group_id,L("")},N=async()=>{let{data:e}=await y.getGroupList(K.value);D.value=e},A=()=>{x.page_num=++x.page_num,C.value>_.value.length&&z()},z=async e=>{let{data:t}=await y.getKeywordList({search_name:e,page_num:x.page_num});!t.list.length||(e&&(_.value=[],_.value=t.list),_.value=[..._.value,...t.list],C.value=t.total_num)},J=()=>{k.value=!1,d.value.length&&d.value[d.value.length-1].length>5&&(d.value.pop(),w.error({message:"\u5173\u952E\u8BCD\u957F\u5EA6\u4E0D\u80FD\u8D85\u8FC75\u4E2A\u5B57\u7B26!"})),console.log("searchKeysVal.value",d.value)},T=e=>{e.length>5&&(H.value.query=e.substring(0,5)),e&&_.value.findIndex(p=>{p.name})===-1&&(k.value=!0)};return z(),N(),(e,t)=>{const p=v("el-option"),G=v("el-select"),h=v("el-form-item"),E=v("el-button"),P=v("el-form"),Q=X,W=ae("el-select-loadmore");return c(),f("div",null,[n("div",null,[n("div",se,[n("div",re," \u521B\u5EFA\u6210\u5458\uFF1A"+m(l.value&&l.value.creator_name||l.value&&l.value.member_name||"\u2014"),1),n("div",ne," \u521B\u5EFA\u65F6\u95F4\uFF1A"+m(l.value&&l.value.create_time||"\u2014"),1),n("div",ue," \u6700\u540E\u4FEE\u6539\u6210\u5458\uFF1A"+m(l.value&&l.value.member_name||"\u2014"),1),n("div",ie," \u6700\u540E\u4FEE\u6539\u65F6\u95F4\uFF1A"+m(l.value&&l.value.update_time||"\u2014"),1)])]),u(Q,{style:{"margin-top":"0px"}},{default:s(()=>[n("div",de,[u(P,{ref:"ruleForm",modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=a=>r.value=a),class:"demo-ruleForm",height:"32px","label-width":"520px","label-position":"top"},{default:s(()=>[u(h,{required:"",label:"\u77E5\u8BC6\u5206\u7EC4"},{default:s(()=>[u(G,{modelValue:r.value.group_id,"onUpdate:modelValue":t[0]||(t[0]=a=>r.value.group_id=a),style:{width:"520px"},"el-select":"",filterable:"","filter-method":L,"default-first-option":"",placeholder:F.value,class:"form-ipt-style","no-match-text":"no data","no-data-text":"no data",disabled:!0,onChange:U},{default:s(()=>[(c(!0),f(M,null,B(D.value,a=>(c(),q(p,{key:a.group_id,label:a.name,value:a.group_id,disabled:a.sale_script_num>=20},{default:s(()=>[n("div",ce,[n("span",null,m(a.name),1),j.value==a.group_id?(c(),f("i",_e)):S("",!0)])]),_:2},1032,["label","value","disabled"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1}),u(h,{label:"\u5173\u952E\u8BCD"},{default:s(()=>[le((c(),q(G,{ref:"inputkeysClone",modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=a=>d.value=a),"allow-create":"",class:"ipt-type keys-overflow-scoll","el-select":"",multiple:"",placeholder:"\u8F93\u5165\u5173\u952E\u8BCD",filterable:"",remote:"","no-match-text":"no data","no-data-text":"no data",size:"small","reserve-keyword":"","default-first-option":"",clearable:"","popper-append-to-body":!1,style:{width:"520px"},"remote-method":T,onChange:J},{default:s(()=>[(c(!0),f(M,null,B(_.value,a=>(c(),q(p,{key:a.keyword_id,label:a.name,value:a.name},{default:s(()=>[n("span",{style:{float:"left",width:"250px",overflow:"hidden","text-overflow":"ellipsis"},title:a.name},m(a.name),9,pe)]),_:2},1032,["label","value"]))),128)),k.value?(c(),f("div",me," \u56DE\u8F66\u4F7F\u7528 ")):S("",!0)]),_:1},8,["modelValue"])),[[W,A]])]),_:1}),u(h,null,{default:s(()=>[n("label",ve,[fe,u(Y,{list:g.value,"check-list":!0},null,8,["list"])])]),_:1}),u(h,{class:"item-button tr"},{default:s(()=>[u(E,{size:"small",onClick:O},{default:s(()=>[ge]),_:1}),u(E,{type:"primary",size:"small",onClick:R},{default:s(()=>[he]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})])}}};var je=oe(ye,[["__scopeId","data-v-f48d1540"]]);export{je as default};
